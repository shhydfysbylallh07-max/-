<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>كافتيريا الخير | خدمة 24 ساعة</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    /* ========== Variables & Reset ========== */
    :root{
      --primary-color:#10b981;
      --primary-dark:#059669;
      --dark-color:#1f2937;
      --light-color:#f9fafb;
      --gray-100:#f3f4f6;
      --gray-200:#e5e7eb;
      --radius:0.5rem;
      --radius-lg:1rem;
      --shadow: 0 4px 6px rgba(0,0,0,0.08);
      --transition: all 0.25s ease;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html{scroll-behavior:smooth}
    body{
      font-family: 'Segoe UI', 'Cairo', 'Noto Sans Arabic', sans-serif;
      background:var(--light-color);
      color:var(--dark-color);
      line-height:1.6;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block;height:auto}

    /* ========== Layout ========== */
    .container{max-width:1200px;margin:0 auto;padding:0 1rem}
    .main-header{
      position:sticky;top:0;z-index:1200;
      background:rgba(255,255,255,0.98);backdrop-filter:blur(6px);
      border-bottom:1px solid var(--gray-200);box-shadow:var(--shadow)
    }
    .header-content{display:flex;align-items:center;justify-content:space-between;padding:1rem 0}
    .logo{display:flex;align-items:center;gap:.75rem}
    .logo-icon{width:40px;height:40px;border-radius:var(--radius);display:flex;align-items:center;justify-content:center;color:#fff;background:linear-gradient(135deg,var(--primary-color),#3b82f6)}
    .logo-text{font-weight:700;font-size:1.25rem;background:linear-gradient(135deg,var(--primary-color),#3b82f6);-webkit-background-clip:text;-webkit-text-fill-color:transparent}

    /* Hero */
    .hero-section{padding:4rem 0;text-align:center;background:linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.45)), url('https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80') center/cover no-repeat;color:white;min-height:50vh;display:flex;align-items:center;justify-content:center}
    .hero-title{font-size:2.5rem;margin-bottom:1rem}
    .hero-sub{opacity:0.95}

    /* Basic cards / grid (kept simple) */
    .section{padding:3rem 0}
    .grid{display:grid;gap:1.5rem;grid-template-columns:repeat(auto-fit,minmax(240px,1fr))}

    /* ========== Admin Panel (fixed & visible) ========== */
    /* This block ensures the admin/control panel is visible, accessible and sits above overlays/modals */
    #admin-panel, .admin-panel{
      position:fixed;
      top:88px; /* below header */
      right:20px; /* RTL: panel appears on the right */
      width:320px;
      max-width:calc(100% - 40px);
      background:#fff;
      color:var(--dark-color);
      border-radius:var(--radius-lg);
      box-shadow:0 20px 40px rgba(0,0,0,0.12);
      padding:1rem;
      z-index:4000 !important; /* ensure above modals */
      display:block !important; /* force show */
      visibility:visible !important;
      opacity:1 !important;
      transform:none !important;
      transition:var(--transition);
      -webkit-overflow-scrolling:touch;
    }

    /* Admin header row */
    #admin-panel .admin-header{display:flex;align-items:center;justify-content:space-between;gap:.5rem;margin-bottom:.75rem}
    #admin-panel .admin-title{font-weight:700}
    #admin-panel .admin-actions{display:flex;gap:.5rem;align-items:center}

    /* Buttons inside admin */
    .btn{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem .85rem;border-radius:8px;border:0;cursor:pointer;transition:var(--transition)}
    .btn-close{background:transparent;color:var(--dark-color);border:1px solid var(--gray-200)}
    .btn-primary{background:linear-gradient(135deg,var(--primary-color),var(--primary-dark));color:#fff}

    /* Make sure modal overlays don't cover admin */
    .modal-overlay{z-index:2000} /* lower than admin-panel */

    /* Responsive adjustments */
    @media (max-width:720px){
      #admin-panel{right:12px;left:12px;top:80px;width:auto}
    }

    /* Accessibility: when admin hidden via .hidden */
    #admin-panel.hidden{display:none !important;visibility:hidden !important;opacity:0 !important;height:0;overflow:hidden}
  </style>
</head>
<body>
  <!-- Header -->
  <header class="main-header" role="banner">
    <div class="container header-content">
      <div class="logo">
        <div class="logo-icon" aria-hidden="true"><i class="fa-solid fa-mug-saucer"></i></div>
        <div class="logo-text">كافتيريا الخير</div>
      </div>

      <nav class="nav-menu" aria-label="القائمة الرئيسية">
        <a class="nav-link" href="#menu">القائمة</a>
        <a class="nav-link" href="#about">من نحن</a>
        <a class="nav-link" href="#contact">تواصل</a>
      </nav>

      <div class="header-actions">
        <button id="admin-toggle" class="btn btn-primary" aria-controls="admin-panel" title="عرض لوحة التحكم">
          <i class="fa-solid fa-gear"></i><span class="sr-only">لوحة التحكم</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Hero -->
  <main>
    <section class="hero-section" role="region" aria-label="الواجهة">
      <div class="container">
        <h1 class="hero-title">كافتيريا الخير — خدمة 24 ساعة</h1>
        <p class="hero-sub">أفضل المشروبات والحلويات مع توصيل سريع وخدمة ممتازة.</p>
      </div>
    </section>

    <section id="menu" class="section container">
      <h2 class="section-title">قائمة المنتجات</h2>
      <div class="grid">
        <div class="card" style="background:#fff;padding:1rem;border-radius:8px;box-shadow:var(--shadow)">
          <h3>قهوة عربية</h3>
          <p>قهوة طازجة وتحضير يدوي.</p>
        </div>
        <div class="card" style="background:#fff;padding:1rem;border-radius:8px;box-shadow:var(--shadow)">
          <h3>كيك التمر</h3>
          <p>حلوى منزلية لذيذة.</p>
        </div>
      </div>
    </section>

    <section id="about" class="section container">
      <h2 class="section-title">من نحن</h2>
      <p class="container" style="max-width:760px;margin:0 auto;text-align:center">نقدم أفضل تجربة قهوة وحلويات، متواجدون على مدار الساعة.</p>
    </section>
  </main>

  <!-- ========== Admin / Control Panel ========== -->
  <!-- This panel is deliberately visible by default. If you want it hidden on load, remove "data-visible" or add the "hidden" class. -->
  <aside id="admin-panel" class="admin-panel" role="complementary" aria-labelledby="admin-title" data-visible="true">
    <div class="admin-header">
      <div class="admin-title" id="admin-title">لوحة التحكم</div>
      <div class="admin-actions">
        <button id="admin-close" class="btn btn-close" aria-label="إغلاق لوحة التحكم"><i class="fa-solid fa-xmark"></i></button>
      </div>
    </div>

    <div class="admin-body" style="font-size:0.95rem;line-height:1.4">
      <p><strong>حالة النظام:</strong> تعمل</p>

      <div style="margin-top:0.75rem">
        <button id="refresh-btn" class="btn" title="تحديث البيانات"><i class="fa-solid fa-arrows-rotate"></i> تحديث</button>
        <button id="toggle-visibility-btn" class="btn" title="إظهار/إخفاء اللوحة"><i class="fa-solid fa-eye-slash"></i> إخفاء</button>
      </div>

      <hr style="margin:0.75rem 0;border:none;border-top:1px solid var(--gray-200)">

      <div style="font-size:0.9rem;color:#555">
        <p><strong>سجل الأخطاء (console)</strong></p>
        <ul id="admin-log" style="max-height:160px;overflow:auto;padding-left:1rem"></ul>
      </div>
    </div>
  </aside>

  <!-- Example modal overlay (kept for structure). modal-overlay has lower z-index than admin panel so it won't cover it. -->
  <div class="modal-overlay" id="example-modal" aria-hidden="true" style="display:none">
    <div class="modal" role="dialog" aria-modal="true" aria-label="مثال مودال" style="padding:1rem">
      <div class="modal-header">
        <h3 class="modal-title">مثال مودال</h3>
        <button class="modal-close" aria-label="إغلاق"><i class="fa-solid fa-xmark"></i></button>
      </div>
      <div class="modal-body">محتوى المودال.</div>
      <div class="modal-footer">
        <button class="btn btn-primary">حسناً</button>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="main-footer" style="background:#111;color:#fff;padding:2rem 0;margin-top:2rem">
    <div class="container">
      <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem">
        <div>© <strong>كافتيريا الخير</strong> 2026</div>
        <div>تواصل معنا: <a href="mailto:info@example.com" style="color:var(--primary-color)">info@example.com</a></div>
      </div>
    </div>
  </footer>

  <!-- ========== Scripts ========== -->
  <script>
    (function(){
      // Helper: safe query
      function $(sel){ return document.querySelector(sel) }

      // Elements
      const adminPanel = $('#admin-panel');
      const adminToggle = $('#admin-toggle');
      const adminClose  = $('#admin-close');
      const toggleVisBtn = $('#toggle-visibility-btn');
      const refreshBtn = $('#refresh-btn');
      const adminLog = $('#admin-log');

      // Safe initialization: if admin panel missing, create a minimal visible one
      if(!adminPanel){
        const ap = document.createElement('aside');
        ap.id = 'admin-panel';
        ap.className = 'admin-panel';
        ap.innerHTML = '<div class="admin-header"><div class="admin-title">لوحة التحكم</div><div class="admin-actions"><button id="admin-close" class="btn btn-close" aria-label="إغلاق">×</button></div></div><div class="admin-body"><p>تم إنشاء لوحة تحكم افتراضية.</p></div>';
        document.body.appendChild(ap);
        console.warn('لوحة التحكم لم تكن موجودة لذلك تم إنشاء واحدة مؤقتة.');
      }

      // Toggle function: show/hide with class and aria
      function toggleAdminPanel(){
        const el = document.getElementById('admin-panel');
        if(!el) return;
        const isHidden = el.classList.contains('hidden');
        if(isHidden){
          el.classList.remove('hidden');
          el.setAttribute('aria-hidden','false');
        } else {
          el.classList.add('hidden');
          el.setAttribute('aria-hidden','true');
        }
      }

      // Bind buttons
      if(adminToggle){
        adminToggle.addEventListener('click', function(e){
          e.preventDefault();
          toggleAdminPanel();
        });
      }
      if(adminClose){
        adminClose.addEventListener('click', function(e){
          e.preventDefault();
          toggleAdminPanel();
        });
      }
      if(toggleVisBtn){
        toggleVisBtn.addEventListener('click', function(){
          toggleAdminPanel();
        });
      }
      if(refreshBtn){
        refreshBtn.addEventListener('click', function(){
          logAdmin('تم طلب تحديث البيانات');
          // Placeholder: place fetch/ajax refresh logic here
          setTimeout(()=> logAdmin('تم تحديث البيانات بنجاح'), 800);
        });
      }

      // Log helper (shows events in admin panel)
      function logAdmin(msg){
        const ul = document.getElementById('admin-log');
        if(!ul) return;
        const li = document.createElement('li');
        const now = new Date().toLocaleTimeString();
        li.textContent = `[${now}] ${msg}`;
        ul.insertBefore(li, ul.firstChild);
      }

      // Report JS errors into admin log (but also keep console behavior)
      window.addEventListener('error', function(ev){
        try{
          logAdmin('خطأ: ' + (ev && ev.message ? ev.message : String(ev)));
        }catch(e){}
      });

      window.addEventListener('unhandledrejection', function(ev){
        try{
          logAdmin('Promise rejection: ' + (ev && ev.reason ? (ev.reason.message || ev.reason) : String(ev)));
        }catch(e){}
      });

      // Ensure admin is visible by default (unless explicitly hidden)
      try{
        const ap = document.getElementById('admin-panel');
        if(ap && ap.getAttribute('data-visible') !== 'false'){
          ap.classList.remove('hidden');
          ap.setAttribute('aria-hidden','false');
        }
      }catch(e){ console.warn(e) }

      // For debug: expose toggle to window so you can run toggleAdminPanel() from Console
      window.toggleAdminPanel = toggleAdminPanel;
      window.logAdmin = logAdmin;

      // Initial log entry
      logAdmin('لوحة التحكم جاهزة');
    })();
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>كافتيريا الخير | خدمة 24 ساعة</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #10b981;
            --primary-dark: #059669;
            --primary-light: #34d399;
            --secondary-color: #3b82f6;
            --secondary-dark: #2563eb;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
            --success-color: #10b981;
            --dark-color: #1f2937;
            --light-color: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --radius-sm: 0.375rem;
            --radius: 0.5rem;
            --radius-md: 0.75rem;
            --radius-lg: 1rem;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            scroll-padding-top: 80px;
        }

        body {
            font-family: 'Segoe UI', 'Cairo', 'Noto Sans Arabic', sans-serif;
            background-color: var(--light-color);
            color: var(--gray-800);
            line-height: 1.6;
            overflow-x: hidden;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        ul, ol {
            list-style: none;
        }

        img {
            max-width: 100%;
            height: auto;
            display: block;
        }

        button, input, textarea, select {
            font-family: inherit;
        }

        .container {
            width: 100%;
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .section {
            padding: 4rem 0;
        }

        .section-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark-color);
            text-align: center;
            margin-bottom: 3rem;
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -0.75rem;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 2px;
        }

        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
        }

        h1 { font-size: 3rem; }
        h2 { font-size: 2.5rem; }
        h3 { font-size: 1.75rem; }
        h4 { font-size: 1.5rem; }
        h5 { font-size: 1.25rem; }
        h6 { font-size: 1rem; }

        @media (max-width: 768px) {
            h1 { font-size: 2.25rem; }
            h2 { font-size: 2rem; }
            h3 { font-size: 1.5rem; }
            .section-title { font-size: 1.75rem; }
            .section { padding: 3rem 0; }
        }

        @media (max-width: 640px) {
            h1 { font-size: 2rem; }
            h2 { font-size: 1.75rem; }
            .section-title { font-size: 1.5rem; }
            .section { padding: 2.5rem 0; }
        }

        /* Button Styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            font-size: 1rem;
            border-radius: var(--radius);
            border: none;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            box-shadow: var(--shadow);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary-color), var(--secondary-dark));
            color: white;
            box-shadow: var(--shadow);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .btn-outline:hover {
            background: var(--primary-color);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger-color), #dc2626);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning-color), #d97706);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-color), var(--primary-dark));
            color: white;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }

        .btn-lg {
            padding: 1rem 2rem;
            font-size: 1.125rem;
        }

        /* Header Styles */
        .main-header {
            background: white;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.98);
            border-bottom: 1px solid var(--gray-200);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-menu {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-link {
            font-weight: 600;
            color: var(--gray-600);
            transition: var(--transition);
            position: relative;
            padding: 0.5rem 0;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 0;
            height: 2px;
            background: var(--primary-color);
            transition: var(--transition);
        }

        .nav-link:hover {
            color: var(--primary-color);
        }

        .nav-link:hover::after {
            width: 100%;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .cart-btn {
            position: relative;
            background: var(--gray-100);
            border: none;
            width: 44px;
            height: 44px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .cart-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }

        .cart-count {
            position: absolute;
            top: -6px;
            left: -6px;
            background: var(--danger-color);
            color: white;
            font-size: 0.75rem;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        /* Hero Section */
        .hero-section {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: white;
            padding: 8rem 0;
            position: relative;
            overflow: hidden;
            min-height: 100vh;
            display: flex;
            align-items: center;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }

        .hero-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            margin-bottom: 2rem;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .hero-title {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
            line-height: 1.1;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .hero-subtitle {
            font-size: 1.25rem;
            margin-bottom: 2.5rem;
            opacity: 0.9;
            line-height: 1.8;
        }

        /* Categories Grid */
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .category-card {
            background: white;
            border-radius: var(--radius-lg);
            padding: 2rem;
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .category-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-color);
        }

        .category-card.active {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(59, 130, 246, 0.1));
        }

        .category-icon {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            color: white;
            font-size: 1.75rem;
        }

        .category-name {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--dark-color);
        }

        .category-count {
            color: var(--gray-600);
            font-size: 0.875rem;
        }

        /* Products Filter */
        .products-filter {
            display: flex;
            justify-content: center;
            gap: 0.75rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.75rem 1.5rem;
            background: var(--gray-100);
            border: none;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            color: var(--gray-700);
        }

        .filter-btn:hover,
        .filter-btn.active {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        /* Products Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
        }

        .product-card {
            background: white;
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
            border: 1px solid var(--gray-200);
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
        }

        .product-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: var(--primary-color);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
            z-index: 2;
        }

        .product-image {
            height: 200px;
            overflow: hidden;
            position: relative;
            background: var(--gray-100);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .product-card:hover .product-image img {
            transform: scale(1.1);
        }

        .product-content {
            padding: 1.5rem;
        }

        .product-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--dark-color);
            line-height: 1.4;
        }

        .product-description {
            color: var(--gray-600);
            font-size: 0.875rem;
            margin-bottom: 1rem;
            line-height: 1.5;
            height: 60px;
            overflow: hidden;
        }

        .product-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
        }

        .product-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .add-to-cart-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .add-to-cart-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.1);
        }

        .add-to-cart-btn:disabled {
            background: var(--gray-400);
            cursor: not-allowed;
            transform: none;
        }

        /* Top Products Section */
        .top-products-section {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }

        .top-products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
        }

        .top-product-card {
            background: white;
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .top-product-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-color);
        }

        .top-product-image {
            height: 200px;
            overflow: hidden;
            background: var(--gray-100);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .top-product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .top-product-content {
            padding: 1.5rem;
        }

        /* Features Grid */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .feature-card {
            background: white;
            padding: 2rem;
            border-radius: var(--radius-lg);
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid var(--gray-200);
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-color);
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            color: white;
            font-size: 1.5rem;
        }

        /* Footer */
        .main-footer {
            background: var(--dark-color);
            color: white;
            padding: 4rem 0 2rem;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .footer-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .footer-description {
            color: var(--gray-300);
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .social-links {
            display: flex;
            gap: 1rem;
        }

        .social-link {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .social-link:hover {
            background: var(--primary-color);
            transform: translateY(-3px);
        }

        .footer-heading {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: white;
        }

        .footer-links li {
            margin-bottom: 0.75rem;
        }

        .footer-links a {
            color: var(--gray-300);
            transition: var(--transition);
            display: inline-block;
        }

        .footer-links a:hover {
            color: var(--primary-color);
            padding-right: 0.5rem;
        }

        .contact-info li {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            margin-bottom: 1rem;
            color: var(--gray-300);
        }

        .contact-info i {
            color: var(--primary-color);
            margin-top: 0.25rem;
            min-width: 20px;
        }

        .copyright {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--gray-300);
            font-size: 0.875rem;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s ease;
            padding: 1rem;
        }

        .modal-overlay.active {
            display: flex;
            opacity: 1;
        }

        .modal {
            background: white;
            border-radius: var(--radius-lg);
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease;
            box-shadow: var(--shadow-lg);
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            background: white;
            z-index: 1;
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--dark-color);
        }

        .modal-body {
            padding: 1.5rem;
            max-height: 60vh;
            overflow-y: auto;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--gray-200);
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            background: var(--gray-100);
            border-radius: 0 0 var(--radius-lg) var(--radius-lg);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--gray-600);
            cursor: pointer;
            transition: var(--transition);
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius);
        }

        .modal-close:hover {
            background: var(--gray-100);
            color: var(--danger-color);
        }

        /* Cart Styles */
        .cart-items {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 0.5rem;
        }

        .cart-item {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            border-bottom: 1px solid var(--gray-200);
            align-items: center;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item-image {
            width: 80px;
            height: 80px;
            border-radius: var(--radius);
            overflow: hidden;
            background: var(--gray-100);
            flex-shrink: 0;
        }

        .cart-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .cart-item-details {
            flex: 1;
            min-width: 0;
        }

        .cart-item-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: var(--dark-color);
            font-size: 1rem;
        }

        .cart-item-price {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 1rem;
        }

        .cart-item-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .quantity-btn {
            width: 32px;
            height: 32px;
            background: var(--gray-100);
            border: none;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
        }

        .quantity-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-1px);
        }

        .quantity-btn:disabled {
            background: var(--gray-200);
            color: var(--gray-400);
            cursor: not-allowed;
            transform: none;
        }

        .cart-item-quantity {
            font-weight: 600;
            min-width: 30px;
            text-align: center;
            font-size: 1rem;
        }

        .cart-summary {
            padding: 1.5rem;
            border-top: 1px solid var(--gray-200);
            background: var(--gray-50);
        }

        .cart-total {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--dark-color);
        }

        .cart-total-price {
            color: var(--primary-color);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark-color);
        }

        .form-control {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius);
            font-size: 1rem;
            transition: var(--transition);
            background: white;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        .form-select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius);
            font-size: 1rem;
            background: white;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%236b7280' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: left 1rem center;
            background-size: 16px;
            padding-left: 2.5rem;
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
            line-height: 1.5;
        }

        /* Image Upload Styles */
        .upload-container {
            border: 2px dashed var(--gray-300);
            border-radius: var(--radius);
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            background: var(--gray-100);
        }

        .upload-container:hover {
            border-color: var(--primary-color);
            background: var(--gray-200);
        }

        .upload-icon {
            font-size: 3rem;
            color: var(--gray-400);
            margin-bottom: 1rem;
        }

        .upload-text {
            color: var(--gray-600);
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .upload-hint {
            color: var(--gray-500);
            font-size: 0.875rem;
        }

        .image-preview {
            margin-top: 1rem;
            border-radius: var(--radius);
            overflow: hidden;
            max-height: 200px;
            display: none;
            border: 1px solid var(--gray-200);
        }

        .image-preview img {
            width: 100%;
            height: auto;
            object-fit: cover;
            display: block;
        }

        .upload-btn {
            margin-top: 1rem;
            display: none;
        }

        /* Admin Panel Styles */
        .admin-panel {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            padding: 2rem;
            margin-top: 2rem;
        }

        .admin-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            border-bottom: 2px solid var(--gray-200);
            padding-bottom: 1rem;
        }

        .admin-tab {
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius);
            cursor: pointer;
            transition: var(--transition);
            border: none;
            background: none;
            font-weight: 600;
            color: var(--gray-600);
        }

        .admin-tab:hover {
            background: var(--gray-100);
            color: var(--gray-800);
        }

        .admin-tab.active {
            background: var(--primary-color);
            color: white;
        }

        .admin-tab-content {
            display: none;
        }

        .admin-tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            text-align: center;
            border: 1px solid var(--gray-200);
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--gray-600);
            font-size: 0.875rem;
        }

        .admin-floating-btn {
            position: fixed;
            bottom: 2rem;
            left: 2rem;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--secondary-color), var(--secondary-dark));
            color: white;
            border: none;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            transition: var(--transition);
        }

        .admin-floating-btn:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-xl);
        }

        .admin-floating-btn.show {
            display: flex;
        }

        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            flex-direction: column;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid var(--gray-200);
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 1rem;
            left: 1rem;
            background: white;
            color: var(--dark-color);
            padding: 1rem 1.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            z-index: 4000;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            max-width: 400px;
            border-right: 4px solid var(--primary-color);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-right-color: var(--success-color);
        }

        .notification.error {
            border-right-color: var(--danger-color);
        }

        .notification.warning {
            border-right-color: var(--warning-color);
        }

        .notification-icon {
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        .notification.success .notification-icon {
            color: var(--success-color);
        }

        .notification.error .notification-icon {
            color: var(--danger-color);
        }

        .notification.warning .notification-icon {
            color: var(--warning-color);
        }

        /* Settings Page */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .setting-card {
            background: white;
            padding: 1.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            border: 1px solid var(--gray-200);
        }

        .setting-card h3 {
            margin-bottom: 1rem;
            color: var(--dark-color);
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--gray-200);
        }

        /* Empty States */
        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--gray-600);
        }

        .empty-state-icon {
            font-size: 4rem;
            color: var(--gray-300);
            margin-bottom: 1rem;
        }

        .empty-state-title {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--gray-700);
        }

        .empty-state-description {
            color: var(--gray-500);
            max-width: 400px;
            margin: 0 auto;
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--gray-100);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        /* Utility Classes */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .text-left { text-align: left; }
        .mt-1 { margin-top: 0.25rem; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-3 { margin-top: 1rem; }
        .mt-4 { margin-top: 1.5rem; }
        .mt-5 { margin-top: 2rem; }
        .mb-1 { margin-bottom: 0.25rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-3 { margin-bottom: 1rem; }
        .mb-4 { margin-bottom: 1.5rem; }
        .mb-5 { margin-bottom: 2rem; }
        .mx-auto { margin-right: auto; margin-left: auto; }
        .d-flex { display: flex; }
        .d-none { display: none; }
        .flex-column { flex-direction: column; }
        .align-items-center { align-items: center; }
        .justify-content-center { justify-content: center; }
        .justify-content-between { justify-content: space-between; }
        .gap-1 { gap: 0.25rem; }
        .gap-2 { gap: 0.5rem; }
        .gap-3 { gap: 1rem; }
        .w-100 { width: 100%; }
        .h-100 { height: 100%; }
        .position-relative { position: relative; }
        .position-absolute { position: absolute; }

        /* Print Styles */
        @media print {
            .main-header,
            .admin-floating-btn,
            .add-to-cart-btn,
            .modal-overlay,
            .main-footer,
            .cart-btn {
                display: none !important;
            }
        }

        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Responsive Improvements */
        @media (max-width: 768px) {
            .container {
                padding: 0 1.5rem;
            }
            
            .header-content {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem 0;
            }
            
            .nav-menu {
                flex-wrap: wrap;
                justify-content: center;
                gap: 1rem;
                width: 100%;
            }
            
            .nav-link {
                font-size: 0.875rem;
                padding: 0.25rem 0.5rem;
            }
            
            .hero-title {
                font-size: 2.5rem;
            }
            
            .hero-subtitle {
                font-size: 1.125rem;
            }
            
            .products-grid,
            .top-products-grid,
            .categories-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 1.5rem;
            }
            
            .admin-tabs {
                flex-direction: column;
            }
            
            .modal {
                width: 95%;
                margin: 1rem;
                max-height: 85vh;
            }
            
            .modal-header,
            .modal-body,
            .modal-footer {
                padding: 1.25rem;
            }
        }

        @media (max-width: 640px) {
            .categories-grid,
            .products-grid,
            .top-products-grid {
                grid-template-columns: 1fr;
            }
            
            .hero-title {
                font-size: 2rem;
            }
            
            .hero-subtitle {
                font-size: 1rem;
            }
            
            .section-title {
                font-size: 1.5rem;
                margin-bottom: 2rem;
            }
            
            .modal {
                width: 100%;
                border-radius: var(--radius);
                max-height: 90vh;
            }
            
            .products-filter {
                gap: 0.5rem;
            }
            
            .filter-btn {
                padding: 0.5rem 1rem;
                font-size: 0.875rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 1rem;
            }
            
            .hero-section {
                padding: 6rem 0;
                min-height: 80vh;
            }
            
            .hero-title {
                font-size: 1.75rem;
            }
            
            .cart-item {
                flex-direction: column;
                text-align: center;
                gap: 0.75rem;
            }
            
            .cart-item-image {
                width: 100px;
                height: 100px;
            }
            
            .cart-item-actions {
                justify-content: center;
            }
            
            .footer-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            
            .admin-floating-btn {
                bottom: 1rem;
                left: 1rem;
                width: 50px;
                height: 50px;
                font-size: 1.25rem;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <p>جاري التحميل...</p>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer"></div>

    <!-- Admin Floating Button - Hidden by default, shown only after login -->
    <button class="admin-floating-btn" id="adminFloatingBtn" title="لوحة التحكم">
        <i class="fas fa-crown"></i>
    </button>

    <!-- Header -->
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-wine-glass-alt"></i>
                    </div>
                    <div class="logo-text">كافتيريا الخير</div>
                </div>

                <nav class="nav-menu">
                    <a href="#home" class="nav-link">الرئيسية</a>
                    <a href="#categories" class="nav-link">التصنيفات</a>
                    <a href="#top-products" class="nav-link">الأكثر طلباً</a>
                    <a href="#products" class="nav-link">قائمة المنتجات</a>
                    <a href="#features" class="nav-link">المميزات</a>
                    <a href="#contact" class="nav-link">اتصل بنا</a>
                </nav>

                <div class="header-actions">
                    <button class="cart-btn" id="cartButton">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-count" id="cartCount">0</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero-section" id="home">
        <div class="container">
            <div class="hero-content">
                <div class="hero-badge">
                    <i class="fas fa-clock"></i>
                    <span>مفتوح 24 ساعة</span>
                </div>
                <h1 class="hero-title" id="heroTitle">استمتع بتجربة عصائر فاخرة لا تُنسى! 🍹</h1>
                <p class="hero-subtitle" id="heroDescription">اكتشف عالمًا من النكهات الراقية مع عصائرنا الطازجة الفاخرة وسندوتشاتنا المميزة - جودة لا مثيل لها في كل قطرة وقضمة!</p>
                <button class="btn btn-primary btn-lg" id="startOrderBtn">
                    <i class="fas fa-play-circle"></i>
                    ابدأ الطلب الآن
                </button>
            </div>
        </div>
    </section>

    <!-- Categories Section -->
    <section class="section categories-section" id="categories">
        <div class="container">
            <h2 class="section-title">تصفح حسب التصنيف</h2>
            <div class="categories-grid" id="categoriesGrid">
                <!-- Categories will be loaded by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Top Products Section -->
    <section class="section top-products-section" id="top-products">
        <div class="container">
            <h2 class="section-title">⭐ الأكثر طلباً</h2>
            <div class="top-products-grid" id="topProductsGrid">
                <!-- Top products will be loaded by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section class="section products-section" id="products">
        <div class="container">
            <h2 class="section-title">🍽️ قائمة المنتجات</h2>
            
            <div class="products-filter" id="productsFilter">
                <!-- Filter buttons will be loaded by JavaScript -->
            </div>

            <div class="products-grid" id="productsGrid">
                <!-- Products will be loaded by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="section features-section" id="features">
        <div class="container">
            <h2 class="section-title">🚀 مميزات كافتيريا الخير</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <h3>مفتوح 24 ساعة</h3>
                    <p>خدمة على مدار الساعة لتلبية احتياجاتك في أي وقت</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-leaf"></i>
                    </div>
                    <h3>مواد طازجة</h3>
                    <p>نستخدم أفضل المواد الطازجة في تحضير منتجاتنا</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-shipping-fast"></i>
                    </div>
                    <h3>توصيل سريع</h3>
                    <p>توصيل في أسرع وقت ممكن مع الحفاظ على الجودة</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-medal"></i>
                    </div>
                    <h3>جودة عالية</h3>
                    <p>نلتزم بأعلى معايير الجودة في جميع منتجاتنا</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <h3>أسعار مناسبة</h3>
                    <p>أفضل الأسعار مع أعلى جودة ممكنة</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3>خدمة عملاء</h3>
                    <p>فريق خدمة عملاء متاح على مدار الساعة</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section class="section contact-section" id="contact">
        <div class="container">
            <h2 class="section-title">📞 اتصل بنا</h2>
            <div class="footer-grid">
                <div>
                    <h3 class="footer-heading">معلومات التواصل</h3>
                    <ul class="contact-info">
                        <li>
                            <i class="fas fa-phone"></i>
                            <span id="storePhone">+967730528609</span>
                        </li>
                        <li>
                            <i class="fas fa-map-marker-alt"></i>
                            <span id="storeAddress">اليمن – تعز – دمنة خدير – الكمب - أمام الملك فون – جوار صيدلية العفيفي</span>
                        </li>
                        <li>
                            <i class="fas fa-clock"></i>
                            <span id="storeHours">مفتوح 24 ساعة</span>
                        </li>
                        <li>
                            <i class="fab fa-whatsapp"></i>
                            <span id="whatsappNumber">واتساب: +967730528609</span>
                        </li>
                        <li>
                            <i class="fas fa-credit-card"></i>
                            <span id="creamyCashInfo">كريمي حاسب: 1299834</span>
                        </li>
                    </ul>
                    
                    <div class="mt-4">
                        <h4 class="footer-heading">طرق الدفع</h4>
                        <ul class="contact-info">
                            <li><i class="fas fa-money-bill-wave"></i> نقداً عند الاستلام</li>
                            <li><i class="fas fa-mobile-alt"></i> تحويل بنكي عبر كريمي حاسب</li>
                        </ul>
                    </div>
                </div>
                
                <div>
                    <h3 class="footer-heading">موقعنا على خرائط جوجل</h3>
                    <div style="margin-top: 1rem; border-radius: var(--radius); overflow: hidden; height: 250px; background: var(--gray-200); position: relative;">
                        <iframe 
                            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3453.363285107948!2d44.019757315115!3d13.578435281333!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2zMTPCsDM0JzQyLjQiTiA0NMKwMDEnMTEuMSJF!5e0!3m2!1sen!2s!4v1620000000000!5m2!1sen!2s" 
                            width="100%" 
                            height="100%" 
                            style="border:0;" 
                            allowfullscreen="" 
                            loading="lazy"
                            referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                        <div style="position: absolute; top: 0; right: 0; left: 0; bottom: 0; pointer-events: none;"></div>
                    </div>
                    <a href="https://maps.google.com/?cid=16347870887758642681&entry=gps" 
                       target="_blank" 
                       rel="noopener noreferrer"
                       class="btn btn-outline w-100 mt-3">
                        <i class="fas fa-map-marker-alt"></i>
                        افتح في خرائط جوجل
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="container">
            <div class="footer-grid">
                <div>
                    <div class="footer-logo">
                        <div class="logo-icon">
                            <i class="fas fa-wine-glass-alt"></i>
                        </div>
                        <div class="logo-text">كافتيريا الخير</div>
                    </div>
                    <p class="footer-description" id="storeDescription">أفضل كافتيريا في اليمن تقدم أجود أنواع العصائر والمشروبات والسندوتشات على مدار 24 ساعة.</p>
                    <div class="social-links">
                        <a href="https://wa.me/967730528609" class="social-link" target="_blank" rel="noopener noreferrer" id="whatsappLink">
                            <i class="fab fa-whatsapp"></i>
                        </a>
                        <a href="tel:+967730528609" class="social-link" id="phoneLink">
                            <i class="fas fa-phone"></i>
                        </a>
                        <a href="#contact" class="social-link">
                            <i class="fas fa-map-marker-alt"></i>
                        </a>
                        <a href="#contact" class="social-link">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>
                
                <div>
                    <h3 class="footer-heading">روابط سريعة</h3>
                    <ul class="footer-links">
                        <li><a href="#home">الرئيسية</a></li>
                        <li><a href="#categories">التصنيفات</a></li>
                        <li><a href="#top-products">الأكثر طلباً</a></li>
                        <li><a href="#products">قائمة المنتجات</a></li>
                        <li><a href="#features">المميزات</a></li>
                        <li><a href="#contact">اتصل بنا</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="footer-heading">التصنيفات</h3>
                    <ul class="footer-links" id="footerCategories">
                        <!-- Categories will be loaded by JavaScript -->
                    </ul>
                </div>
            </div>
            
            <div class="copyright">
                <p>© <span id="currentYear">2024</span> كافتيريا الخير. جميع الحقوق محفوظة.</p>
                <p class="mt-2">تصميم وتطوير: فريق كافتيريا الخير</p>
            </div>
        </div>
    </footer>

    <!-- Cart Modal -->
    <div class="modal-overlay" id="cartModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">🛒 سلة التسوق</h3>
                <button class="modal-close" id="closeCartModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="cart-items" id="cartItems">
                    <!-- Cart items will be loaded by JavaScript -->
                </div>
                <div class="cart-summary">
                    <div class="cart-total">
                        <span>الإجمالي:</span>
                        <span class="cart-total-price" id="cartTotalPrice">0 ريال</span>
                    </div>
                    <button class="btn btn-primary btn-lg w-100" id="checkoutBtn">
                        <i class="fas fa-shopping-bag"></i>
                        تأكيد الطلب وإرساله عبر واتساب
                    </button>
                </div>
            </div>
        </div>
    </div>
        <!-- Admin Login Modal -->
    <div class="modal-overlay" id="loginModal">
        <div class="modal" style="max-width: 400px;">
            <div class="modal-header">
                <h3 class="modal-title">🔐 تسجيل الدخول</h3>
                <button class="modal-close" id="closeLoginModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">اسم المستخدم</label>
                    <input type="text" class="form-control" id="adminUsername" placeholder="أدخل اسم المستخدم" autocomplete="username">
                </div>
                <div class="form-group">
                    <label class="form-label">كلمة المرور</label>
                    <input type="password" class="form-control" id="adminPassword" placeholder="أدخل كلمة المرور" autocomplete="current-password">
                </div>
                <div class="mt-4 text-center">
                    <small class="text-gray-600">بيانات الدخول الافتراضية: admin / admin123</small>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancelLoginBtn">إلغاء</button>
                <button class="btn btn-primary" id="loginBtn">تسجيل الدخول</button>
            </div>
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div class="modal-overlay" id="adminPanel">
        <div class="modal" style="max-width: 900px;">
            <div class="modal-header">
                <h3 class="modal-title">👑 لوحة التحكم - كافتيريا الخير</h3>
                <button class="modal-close" id="closeAdminPanel">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Admin Tabs -->
                <div class="admin-tabs">
                    <button class="admin-tab active" data-tab="stats">📊 الإحصائيات</button>
                    <button class="admin-tab" data-tab="hero">🏠 الصفحة الرئيسية</button>
                    <button class="admin-tab" data-tab="products">📦 المنتجات</button>
                    <button class="admin-tab" data-tab="top-products">⭐ المنتجات المميزة</button>
                    <button class="admin-tab" data-tab="categories">🗂️ التصنيفات</button>
                    <button class="admin-tab" data-tab="orders">📋 الطلبات</button>
                    <button class="admin-tab" data-tab="settings">⚙️ الإعدادات</button>
                </div>

                <!-- Stats Tab -->
                <div class="admin-tab-content active" id="statsTab">
                    <div class="admin-stats">
                        <div class="stat-card">
                            <div class="stat-value" id="statProducts">0</div>
                            <div class="stat-label">إجمالي المنتجات</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="statCategories">0</div>
                            <div class="stat-label">التصنيفات</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="statOrders">0</div>
                            <div class="stat-label">الطلبات اليوم</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="statRevenue">0</div>
                            <div class="stat-label">إجمالي الإيرادات</div>
                        </div>
                    </div>
                    
                    <h3 class="mt-4 mb-3">📈 ملخص النظام</h3>
                    <div class="setting-card">
                        <p><strong>👑 اسم المتجر:</strong> <span id="storeNameDisplay">كافتيريا الخير</span></p>
                        <p><strong>📞 رقم الهاتف:</strong> <span id="storePhoneDisplay">+967730528609</span></p>
                        <p><strong>📍 العنوان:</strong> <span id="storeAddressDisplay">اليمن – تعز – دمنة خدير – الكمب - أمام الملك فون – جوار صيدلية العفيفي</span></p>
                        <p><strong>⏰ ساعات العمل:</strong> <span id="storeHoursDisplay">مفتوح 24 ساعة</span></p>
                        <p><strong>💰 العملة:</strong> <span id="currencyDisplay">ريال يمني</span></p>
                    </div>
                </div>

                <!-- Hero Tab -->
                <div class="admin-tab-content" id="heroTab">
                    <div class="form-group">
                        <label class="form-label">عنوان الصفحة الرئيسية</label>
                        <input type="text" class="form-control" id="heroTitleInput" placeholder="أدخل العنوان الرئيسي">
                    </div>
                    <div class="form-group">
                        <label class="form-label">وصف الصفحة الرئيسية</label>
                        <textarea class="form-control form-textarea" id="heroDescriptionInput" placeholder="أدخل الوصف الرئيسي"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">صورة الخلفية الحالية</label>
                        <div id="currentHeroPreview" style="height: 150px; background-size: cover; background-position: center; border-radius: var(--radius); margin-bottom: 1rem; border: 2px solid var(--gray-300);"></div>
                        
                        <label class="form-label">تغيير صورة الخلفية</label>
                        <div class="upload-container" id="heroUploadContainer">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <div class="upload-text">انقر أو اسحب الصورة هنا</div>
                            <div class="upload-hint">JPG, PNG أو GIF (الحد الأقصى: 5MB)</div>
                            <input type="file" id="heroImageInput" accept="image/*" style="display: none;">
                        </div>
                        <div class="image-preview" id="heroImagePreview">
                            <img src="" alt="معاينة الصورة">
                        </div>
                        <button class="btn btn-secondary upload-btn w-100 mt-2" id="saveHeroImageBtn">💾 حفظ صورة الخلفية</button>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-outline" id="resetHeroBtn">🔄 إعادة تعيين</button>
                        <button class="btn btn-primary" id="saveHeroBtn">💾 حفظ التغييرات</button>
                    </div>
                </div>

                <!-- Products Tab -->
                <div class="admin-tab-content" id="productsTab">
                    <button class="btn btn-primary w-100 mb-3" id="addProductBtn">
                        <i class="fas fa-plus"></i> إضافة منتج جديد
                    </button>
                    <div id="productsList" style="max-height: 400px; overflow-y: auto; padding: 1rem; background: var(--gray-50); border-radius: var(--radius);">
                        <!-- Products list will be loaded here -->
                    </div>
                </div>

                <!-- Top Products Tab -->
                <div class="admin-tab-content" id="topProductsTab">
                    <button class="btn btn-warning w-100 mb-3" id="addTopProductBtn">
                        <i class="fas fa-plus"></i> إضافة منتج مميز
                    </button>
                    <div id="topProductsList" style="max-height: 400px; overflow-y: auto; padding: 1rem; background: var(--gray-50); border-radius: var(--radius);">
                        <!-- Top products list will be loaded here -->
                    </div>
                </div>

                <!-- Categories Tab -->
                <div class="admin-tab-content" id="categoriesTab">
                    <button class="btn btn-secondary w-100 mb-3" id="addCategoryBtn">
                        <i class="fas fa-plus"></i> إضافة تصنيف جديد
                    </button>
                    <div id="categoriesList" style="max-height: 400px; overflow-y: auto; padding: 1rem; background: var(--gray-50); border-radius: var(--radius);">
                        <!-- Categories list will be loaded here -->
                    </div>
                </div>

                <!-- Orders Tab -->
                <div class="admin-tab-content" id="ordersTab">
                    <div id="ordersList" style="max-height: 400px; overflow-y: auto; padding: 1rem; background: var(--gray-50); border-radius: var(--radius);">
                        <!-- Orders list will be loaded here -->
                    </div>
                </div>

                <!-- Settings Tab -->
                <div class="admin-tab-content" id="settingsTab">
                    <div class="settings-grid">
                        <div class="setting-card">
                            <h3>🏪 معلومات المتجر</h3>
                            <div class="form-group">
                                <label class="form-label">اسم المتجر</label>
                                <input type="text" class="form-control" id="storeNameInput" placeholder="اسم المتجر">
                            </div>
                            <div class="form-group">
                                <label class="form-label">رقم الهاتف</label>
                                <input type="text" class="form-control" id="storePhoneInput" placeholder="رقم الهاتف">
                            </div>
                            <div class="form-group">
                                <label class="form-label">العنوان</label>
                                <textarea class="form-control form-textarea" id="storeAddressInput" placeholder="عنوان المتجر"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ساعات العمل</label>
                                <input type="text" class="form-control" id="storeHoursInput" placeholder="ساعات العمل">
                            </div>
                            <div class="form-group">
                                <label class="form-label">وصف المتجر</label>
                                <textarea class="form-control form-textarea" id="storeDescriptionInput" placeholder="وصف قصير عن المتجر"></textarea>
                            </div>
                        </div>
                        
                        <div class="setting-card">
                            <h3>⚙️ إعدادات النظام</h3>
                            <div class="form-group">
                                <label class="form-label">العملة</label>
                                <select class="form-select" id="currencyInput">
                                    <option value="ريال">ريال يمني</option>
                                    <option value="$">دولار أمريكي ($)</option>
                                    <option value="€">يورو (€)</option>
                                    <option value="د.إ">درهم إماراتي</option>
                                    <option value="ر.س">ريال سعودي</option>
                                    <option value="دينار">دينار كويتي</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">رقم واتساب للطلبات</label>
                                <input type="text" class="form-control" id="whatsappNumberInput" placeholder="رقم واتساب">
                            </div>
                            <div class="form-group">
                                <label class="form-label">رقم نقطة حاسب كريمي</label>
                                <input type="text" class="form-control" id="creamyCashInput" placeholder="رقم نقطة حاسب كريمي">
                            </div>
                            <div class="form-group">
                                <label class="form-label">رابط خرائط جوجل</label>
                                <input type="text" class="form-control" id="googleMapsInput" placeholder="رابط خرائط جوجل">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-danger" id="resetSettingsBtn">🔄 إعادة تعيين جميع الإعدادات</button>
                        <button class="btn btn-primary" id="saveSettingsBtn">💾 حفظ الإعدادات</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger w-100" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> تسجيل الخروج
                </button>
            </div>
        </div>
    </div>

    <!-- Product Form Modal -->
    <div class="modal-overlay" id="productFormModal">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title" id="productFormTitle">➕ إضافة منتج جديد</h3>
                <button class="modal-close" id="closeProductForm">&times;</button>
            </div>
            <div class="modal-body">
                <form id="productForm">
                    <input type="hidden" id="productId">
                    <div class="form-group">
                        <label class="form-label">اسم المنتج</label>
                        <input type="text" class="form-control" id="productNameInput" required placeholder="أدخل اسم المنتج">
                    </div>
                    <div class="form-group">
                        <label class="form-label">الوصف</label>
                        <textarea class="form-control form-textarea" id="productDescriptionInput" required placeholder="أدخل وصف المنتج"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">السعر (<span id="currencySymbol">ريال</span>)</label>
                        <input type="number" class="form-control" id="productPriceInput" required placeholder="أدخل السعر" min="0" step="100">
                    </div>
                    <div class="form-group">
                        <label class="form-label">التصنيف</label>
                        <select class="form-select" id="productCategoryInput" required>
                            <!-- Categories will be loaded here -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">حالة المنتج</label>
                        <select class="form-select" id="productStatusInput">
                            <option value="available">✅ متوفر</option>
                            <option value="unavailable">❌ غير متوفر</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">صورة المنتج</label>
                        <div class="upload-container" id="productUploadContainer">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <div class="upload-text">انقر أو اسحب صورة المنتج هنا</div>
                            <div class="upload-hint">JPG, PNG أو GIF (الحد الأقصى: 5MB)</div>
                            <input type="file" id="productImageInput" accept="image/*" style="display: none;">
                        </div>
                        <div class="image-preview" id="productImagePreview">
                            <img src="" alt="معاينة صورة المنتج">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancelProductBtn">إلغاء</button>
                <button class="btn btn-primary" id="saveProductBtn">💾 حفظ المنتج</button>
            </div>
        </div>
    </div>

    <!-- Top Product Form Modal -->
    <div class="modal-overlay" id="topProductFormModal">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title" id="topProductFormTitle">➕ إضافة منتج مميز</h3>
                <button class="modal-close" id="closeTopProductForm">&times;</button>
            </div>
            <div class="modal-body">
                <form id="topProductForm">
                    <input type="hidden" id="topProductId">
                    <div class="form-group">
                        <label class="form-label">اسم المنتج المميز</label>
                        <input type="text" class="form-control" id="topProductNameInput" required placeholder="أدخل اسم المنتج المميز">
                    </div>
                    <div class="form-group">
                        <label class="form-label">الوصف</label>
                        <textarea class="form-control form-textarea" id="topProductDescriptionInput" required placeholder="أدخل وصف المنتج المميز"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">السعر (<span id="topCurrencySymbol">ريال</span>)</label>
                        <input type="number" class="form-control" id="topProductPriceInput" required placeholder="أدخل السعر" min="0" step="100">
                    </div>
                    <div class="form-group">
                        <label class="form-label">صورة المنتج المميز</label>
                        <div class="upload-container" id="topProductUploadContainer">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <div class="upload-text">انقر أو اسحب صورة المنتج المميز هنا</div>
                            <div class="upload-hint">JPG, PNG أو GIF (الحد الأقصى: 5MB)</div>
                            <input type="file" id="topProductImageInput" accept="image/*" style="display: none;">
                        </div>
                        <div class="image-preview" id="topProductImagePreview">
                            <img src="" alt="معاينة صورة المنتج المميز">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancelTopProductBtn">إلغاء</button>
                <button class="btn btn-primary" id="saveTopProductBtn">💾 حفظ المنتج المميز</button>
            </div>
        </div>
    </div>

    <!-- Category Form Modal -->
    <div class="modal-overlay" id="categoryFormModal">
        <div class="modal" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title" id="categoryFormTitle">➕ إضافة تصنيف جديد</h3>
                <button class="modal-close" id="closeCategoryForm">&times;</button>
            </div>
            <div class="modal-body">
                <form id="categoryForm">
                    <input type="hidden" id="categoryId">
                    <div class="form-group">
                        <label class="form-label">اسم التصنيف</label>
                        <input type="text" class="form-control" id="categoryNameInput" required placeholder="أدخل اسم التصنيف">
                    </div>
                    <div class="form-group">
                        <label class="form-label">أيقونة التصنيف</label>
                        <select class="form-select" id="categoryIconInput">
                            <option value="fas fa-glass-whiskey">🍹 عصائر</option>
                            <option value="fas fa-wine-bottle">🥤 مشروبات</option>
                            <option value="fas fa-blender">🍓 سموثيز</option>
                            <option value="fas fa-ice-cream">🥛 ميلك شيك</option>
                            <option value="fas fa-hamburger">🍔 سندوتشات</option>
                            <option value="fas fa-cookie-bite">🥨 وجبات خفيفة</option>
                            <option value="fas fa-birthday-cake">🍰 حلويات</option>
                            <option value="fas fa-coffee">☕ قهوة</option>
                            <option value="fas fa-pizza-slice">🍕 بيتزا</option>
                            <option value="fas fa-utensils">🍽️ وجبات رئيسية</option>
                            <option value="fas fa-seedling">🌿 أكل صحي</option>
                            <option value="fas fa-fire">🔥 أطباق حارة</option>
                            <option value="fas fa-fish">🐟 مأكولات بحرية</option>
                            <option value="fas fa-drumstick-bite">🍗 دجاج</option>
                            <option value="fas fa-cheese">🧀 جبن</option>
                            <option value="fas fa-lemon">🍋 عصائر حمضية</option>
                            <option value="fas fa-apple-alt">🍏 عصائر طبيعية</option>
                            <option value="fas fa-ice-cream">🍦 آيس كريم</option>
                            <option value="fas fa-bread-slice">🍞 معجنات</option>
                            <option value="fas fa-mug-hot">🍵 شاي</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancelCategoryBtn">إلغاء</button>
                <button class="btn btn-primary" id="saveCategoryBtn">💾 حفظ التصنيف</button>
            </div>
        </div>
    </div>

    <!-- Order Details Modal -->
    <div class="modal-overlay" id="orderDetailsModal">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title">📋 تفاصيل الطلب #<span id="orderDetailsId"></span></h3>
                <button class="modal-close" id="closeOrderDetails">&times;</button>
            </div>
            <div class="modal-body">
                <div id="orderDetailsContent">
                    <!-- Order details will be loaded here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="closeOrderBtn">إغلاق</button>
                <button class="btn btn-danger" id="cancelOrderBtn">❌ إلغاء الطلب</button>
                <button class="btn btn-success" id="completeOrderBtn">✅ تأكيد الاستلام</button>
            </div>
        </div>
    </div>

    <script>
        // ===== CONSTANTS & CONFIGURATION =====
        const ADMIN_CREDENTIALS = {
            username: "admin",
            password: "admin123"
        };
        
        // Version 5 - Updated for fixes
        const STORAGE_KEYS = {
            PRODUCTS: 'kafeteria_products_v5',
            CATEGORIES: 'kafeteria_categories_v5',
            TOP_PRODUCTS: 'kafeteria_top_products_v5',
            ORDERS: 'kafeteria_orders_v5',
            CART: 'kafeteria_cart_v5',
            SETTINGS: 'kafeteria_settings_v5',
            HERO: 'kafeteria_hero_v5',
            IMAGES: 'kafeteria_images_v5',
            ADMIN_TOKEN: 'kafeteria_admin_token_v5'
        };
        
        const DEFAULT_SETTINGS = {
            storeName: "كافتيريا الخير",
            storePhone: "+967730528609",
            storeAddress: "اليمن – تعز – دمنة خدير – الكمب - أمام الملك فون – جوار صيدلية العفيفي",
            storeHours: "مفتوح 24 ساعة",
            storeDescription: "أفضل كافتيريا في اليمن تقدم أجود أنواع العصائر والمشروبات والسندوتشات على مدار 24 ساعة.",
            currency: "ريال",
            whatsappNumber: "+967730528609",
            creamyCash: "1299834",
            googleMaps: "https://maps.google.com/?cid=16347870887758642681&entry=gps"
        };
        
        const DEFAULT_HERO = {
            title: "استمتع بتجربة عصائر فاخرة لا تُنسى! 🍹",
            description: "اكتشف عالمًا من النكهات الراقية مع عصائرنا الطازجة الفاخرة وسندوتشاتنا المميزة - جودة لا مثيل لها في كل قطرة وقضمة!",
            backgroundImage: "https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80"
        };

        // ===== GLOBAL STATE =====
        let state = {
            products: [],
            categories: [],
            topProducts: [],
            cart: [],
            orders: [],
            settings: {},
            hero: {},
            images: {},
            currentCategory: 'all',
            isAdmin: false,
            currentProductId: null,
            currentTopProductId: null,
            currentOrderId: null,
            tempHeroImage: null,
            tempProductImage: null,
            tempTopProductImage: null
        };

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
        });

        function initializeApp() {
            showLoading();
            
            // Check admin login status
            const adminToken = localStorage.getItem(STORAGE_KEYS.ADMIN_TOKEN);
            state.isAdmin = adminToken === 'logged_in';
            
            // Load data from localStorage
            loadAllData();
            
            // Initialize with sample data if empty
            if (state.products.length === 0) {
                initializeSampleData();
            }
            
            // Update UI based on admin status
            updateAdminUI();
            
            // Set current year in footer
            document.getElementById('currentYear').textContent = new Date().getFullYear();
            
            // Render everything
            renderAll();
            
            hideLoading();
        }

        function loadAllData() {
            try {
                // Load products
                const savedProducts = localStorage.getItem(STORAGE_KEYS.PRODUCTS);
                if (savedProducts) state.products = JSON.parse(savedProducts);
                
                // Load categories
                const savedCategories = localStorage.getItem(STORAGE_KEYS.CATEGORIES);
                if (savedCategories) state.categories = JSON.parse(savedCategories);
                
                // Load top products
                const savedTopProducts = localStorage.getItem(STORAGE_KEYS.TOP_PRODUCTS);
                if (savedTopProducts) state.topProducts = JSON.parse(savedTopProducts);
                
                // Load cart
                const savedCart = localStorage.getItem(STORAGE_KEYS.CART);
                if (savedCart) state.cart = JSON.parse(savedCart);
                
                // Load orders
                const savedOrders = localStorage.getItem(STORAGE_KEYS.ORDERS);
                if (savedOrders) state.orders = JSON.parse(savedOrders);
                
                // Load settings
                const savedSettings = localStorage.getItem(STORAGE_KEYS.SETTINGS);
                state.settings = savedSettings ? JSON.parse(savedSettings) : { ...DEFAULT_SETTINGS };
                
                // Load hero data
                const savedHero = localStorage.getItem(STORAGE_KEYS.HERO);
                state.hero = savedHero ? JSON.parse(savedHero) : { ...DEFAULT_HERO };
                
                // Load images
                const savedImages = localStorage.getItem(STORAGE_KEYS.IMAGES);
                if (savedImages) state.images = JSON.parse(savedImages);
                
            } catch (error) {
                console.error('Error loading data:', error);
                showNotification('حدث خطأ في تحميل البيانات', 'error');
            }
        }

        function saveAllData() {
            try {
                localStorage.setItem(STORAGE_KEYS.PRODUCTS, JSON.stringify(state.products));
                localStorage.setItem(STORAGE_KEYS.CATEGORIES, JSON.stringify(state.categories));
                localStorage.setItem(STORAGE_KEYS.TOP_PRODUCTS, JSON.stringify(state.topProducts));
                localStorage.setItem(STORAGE_KEYS.CART, JSON.stringify(state.cart));
                localStorage.setItem(STORAGE_KEYS.ORDERS, JSON.stringify(state.orders));
                localStorage.setItem(STORAGE_KEYS.SETTINGS, JSON.stringify(state.settings));
                localStorage.setItem(STORAGE_KEYS.HERO, JSON.stringify(state.hero));
                localStorage.setItem(STORAGE_KEYS.IMAGES, JSON.stringify(state.images));
            } catch (error) {
                console.error('Error saving data:', error);
                showNotification('حدث خطأ في حفظ البيانات', 'error');
            }
        }

        function initializeSampleData() {
            // Initialize categories with 20 different categories
            state.categories = [
                { id: 1, name: "عصائر فواكه", icon: "fas fa-glass-whiskey", productCount: 0 },
                { id: 2, name: "عصائر طازجة", icon: "fas fa-wine-bottle", productCount: 0 },
                { id: 3, name: "سموثيز", icon: "fas fa-blender", productCount: 0 },
                { id: 4, name: "ميلك شيك", icon: "fas fa-ice-cream", productCount: 0 },
                { id: 5, name: "سندوتشات", icon: "fas fa-hamburger", productCount: 0 },
                { id: 6, name: "وجبات خفيفة", icon: "fas fa-cookie-bite", productCount: 0 },
                { id: 7, name: "حلويات", icon: "fas fa-birthday-cake", productCount: 0 },
                { id: 8, name: "مشروبات ساخنة", icon: "fas fa-coffee", productCount: 0 },
                { id: 9, name: "بيتزا", icon: "fas fa-pizza-slice", productCount: 0 },
                { id: 10, name: "وجبات رئيسية", icon: "fas fa-utensils", productCount: 0 },
                { id: 11, name: "أكل صحي", icon: "fas fa-seedling", productCount: 0 },
                { id: 12, name: "أطباق حارة", icon: "fas fa-fire", productCount: 0 },
                { id: 13, name: "مأكولات بحرية", icon: "fas fa-fish", productCount: 0 },
                { id: 14, name: "دجاج", icon: "fas fa-drumstick-bite", productCount: 0 },
                { id: 15, name: "جبن", icon: "fas fa-cheese", productCount: 0 },
                { id: 16, name: "عصائر حمضية", icon: "fas fa-lemon", productCount: 0 },
                { id: 17, name: "عصائر طبيعية", icon: "fas fa-apple-alt", productCount: 0 },
                { id: 18, name: "آيس كريم", icon: "fas fa-ice-cream", productCount: 0 },
                { id: 19, name: "معجنات", icon: "fas fa-bread-slice", productCount: 0 },
                { id: 20, name: "شاي", icon: "fas fa-mug-hot", productCount: 0 }
            ];

            // Initialize top products
            state.topProducts = [
                {
                    id: 1,
                    name: "عصير برتقال فاخر",
                    description: "عصير برتقال طبيعي 100% مع قطع البرتقال الطازجة، غني بفيتامين سي",
                    price: 500,
                    image: "https://images.unsplash.com/photo-1623065687346-7e23c4c2b19b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 2,
                    name: "سموثي فراولة مميز",
                    description: "مزيج من الفراولة والموز الطازج مع الحليب والزبادي، غني بالطاقة",
                    price: 800,
                    image: "https://images.unsplash.com/photo-1600271886742-f049cd451bba?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 3,
                    name: "سندويتش جبنة مشوية",
                    description: "جبنة شيدر مشوية مع خضار طازجة وصوص خاص، في خبز طازج",
                    price: 1500,
                    image: "https://images.unsplash.com/photo-1567234669003-dce7a7a88821?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 4,
                    name: "بيتزا خضار",
                    description: "بيتزا طازجة مع خضار مشكلة وجبنة موتزاريلا",
                    price: 2500,
                    image: "https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 5,
                    name: "آيس كريم شوكولاتة",
                    description: "آيس كريم شوكولاتة بلجيكي مع مكسرات وكريمة",
                    price: 900,
                    image: "https://images.unsplash.com/photo-1497034825429-c343d7c6a68f?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    createdAt: new Date().toISOString()
                }
            ];

            // Initialize products (30 different products)
            state.products = [
                {
                    id: 1,
                    name: "عصير برتقال طازج",
                    description: "عصير برتقال طبيعي 100% مع قطع البرتقال الطازجة، غني بفيتامين سي",
                    price: 500,
                    category: "عصائر فواكه",
                    image: "https://images.unsplash.com/photo-1623065687346-7e23c4c2b19b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 2,
                    name: "عصير مانجو طبيعي",
                    description: "عصير مانجو حلو مع قطع المانجو الطازجة، طعم استوائي لا يقاوم",
                    price: 700,
                    category: "عصائر فواكه",
                    image: "https://images.unsplash.com/photo-1603561596112-0a132a716fcf?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 3,
                    name: "سموثي فراولة وموز",
                    description: "مزيج من الفراولة والموز الطازج مع الحليب والزبادي، غني بالطاقة",
                    price: 800,
                    category: "سموثيز",
                    image: "https://images.unsplash.com/photo-1600271886742-f049cd451bba?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 4,
                    name: "ميلك شيك شوكولاتة",
                    description: "ميلك شيك كريمي بنكهة الشوكولاتة البلجيكية، مع الكريمة المخفوقة",
                    price: 900,
                    category: "ميلك شيك",
                    image: "https://images.unsplash.com/photo-1572490122747-3968b75cc699?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 5,
                    name: "سندويتش جبنة مشوية",
                    description: "جبنة شيدر مشوية مع خضار طازجة وصوص خاص، في خبز طازج",
                    price: 1500,
                    category: "سندوتشات",
                    image: "https://images.unsplash.com/photo-1567234669003-dce7a7a88821?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 6,
                    name: "كريب نوتيلا",
                    description: "كريب طازج محشو بنوتيلا الشهيرة ومغطى بالمكسرات والكريمة",
                    price: 1200,
                    category: "حلويات",
                    image: "https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 7,
                    name: "قهوة عربية",
                    description: "قهوة عربية أصيلة بطعم ورائحة لا تقاوم، مع الهيل",
                    price: 600,
                    category: "مشروبات ساخنة",
                    image: "https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 8,
                    name: "بطاطس مقلية",
                    description: "بطاطس مقلية طازجة مع صلصة خاصة، مقرمشة ولذيذة",
                    price: 800,
                    category: "وجبات خفيفة",
                    image: "https://images.unsplash.com/photo-1568901346375-23c9450c58cd?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 9,
                    name: "بيتزا مارجريتا",
                    description: "بيتزا إيطالية كلاسيكية مع صلصة الطماطم وجبنة موتزاريلا",
                    price: 2800,
                    category: "بيتزا",
                    image: "https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 10,
                    name: "وجبة دجاج مشوي",
                    description: "دجاج مشوي مع أرز وخضار مشكلة، وجبة متكاملة",
                    price: 3500,
                    category: "وجبات رئيسية",
                    image: "https://images.unsplash.com/photo-1603360946369-dc9bb6258143?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 11,
                    name: "سلطة سيزر",
                    description: "سلطة طازجة مع خس، دجاج، كراوتون، وجبنة بارميزان",
                    price: 1800,
                    category: "أكل صحي",
                    image: "https://images.unsplash.com/photo-1540420773420-3366772f4999?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 12,
                    name: "شطيرة دجاج حارة",
                    description: "دجاج حار مع خضار وصلصة خاصة في خبز طازج",
                    price: 2000,
                    category: "أطباق حارة",
                    image: "https://images.unsplash.com/photo-1565299507177-b0ac66763828?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 13,
                    name: "ساندويتش تونة",
                    description: "تونة طازجة مع خضار ومايونيز في خبز فرنسي",
                    price: 1700,
                    category: "مأكولات بحرية",
                    image: "https://images.unsplash.com/photo-1559054663-e8d23213f55c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 14,
                    name: "دجاج كنتاكي",
                    description: "دجاج مقلي بطريقة كنتاكي مع البطاطس والصلصة",
                    price: 3200,
                    category: "دجاج",
                    image: "https://images.unsplash.com/photo-1626082895612-9e6d8e7c4a2e?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 15,
                    name: "جبنة هالومي مشوية",
                    description: "جبنة هالومي مشوية مع زيت الزيتون والزعتر",
                    price: 1600,
                    category: "جبن",
                    image: "https://images.unsplash.com/photo-1488477181946-6428a0291777?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 16,
                    name: "عصير ليمون بالنعناع",
                    description: "عصير ليمون طازج مع نعناع وقطع ثلج، منعش وصحي",
                    price: 600,
                    category: "عصائر حمضية",
                    image: "https://images.unsplash.com/photo-1600271886742-f049cd451bba?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 17,
                    name: "عصير تفاح طبيعي",
                    description: "عصير تفاح طبيعي 100% بدون سكر مضاف",
                    price: 650,
                    category: "عصائر طبيعية",
                    image: "https://images.unsplash.com/photo-1600271886742-f049cd451bba?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 18,
                    name: "آيس كريم فانيليا",
                    description: "آيس كريم فانيليا كريمي مع صلصة شوكولاتة",
                    price: 850,
                    category: "آيس كريم",
                    image: "https://images.unsplash.com/photo-1497034825429-c343d7c6a68f?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 19,
                    name: "كرواسون",
                    description: "كرواسون فرنسي طازج مع زبدة، ساندويتش رائع",
                    price: 900,
                    category: "معجنات",
                    image: "https://images.unsplash.com/photo-1555507036-ab794f27d2e9?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                },
                {
                    id: 20,
                    name: "شاي أخضر",
                    description: "شاي أخضر طبيعي مع نعناع، مشروب صحي ومنعش",
                    price: 500,
                    category: "شاي",
                    image: "https://images.unsplash.com/photo-1560343090-f0409e92791a?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    status: "available",
                    createdAt: new Date().toISOString()
                }
            ];

            // Update product counts in categories
            updateCategoryCounts();
            
            // Initialize sample orders
            state.orders = [
                {
                    id: 1001,
                    items: [
                        { productId: 1, name: "عصير برتقال طازج", price: 500, quantity: 2 },
                        { productId: 5, name: "سندويتش جبنة مشوية", price: 1500, quantity: 1 }
                    ],
                    total: 2500,
                    status: "completed",
                    date: new Date().toISOString(),
                    customerName: "محمد أحمد",
                    customerPhone: "+967123456789",
                    customerAddress: "تعز - شارع الرئيسي",
                    notes: "بدون ملح في السندويتش"
                }
            ];

            // Store hero image in images
            if (state.hero.backgroundImage && !state.hero.backgroundImage.startsWith('data:')) {
                state.images['hero_background'] = state.hero.backgroundImage;
            }

            // Store default product images
            state.products.forEach((product, index) => {
                const imageKey = `product_${product.id}`;
                if (!state.images[imageKey]) {
                    state.images[imageKey] = product.image;
                }
            });

            state.topProducts.forEach((product, index) => {
                const imageKey = `top_product_${product.id}`;
                if (!state.images[imageKey]) {
                    state.images[imageKey] = product.image;
                }
            });

            saveAllData();
        }

        // ===== RENDER FUNCTIONS =====
        function renderAll() {
            renderHero();
            renderCategories();
            renderTopProducts();
            renderCategoryFilter();
            renderProducts();
            renderFooterCategories();
            updateCartUI();
            updateSettingsUI();
            updateAdminStats();
        }

        function renderHero() {
            const heroSection = document.querySelector('.hero-section');
            const heroTitle = document.getElementById('heroTitle');
            const heroDescription = document.getElementById('heroDescription');
            
            if (heroSection && state.hero.backgroundImage) {
                // Check if image is stored locally
                if (state.images['hero_background'] && state.images['hero_background'].startsWith('data:')) {
                    heroSection.style.backgroundImage = `linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('${state.images['hero_background']}')`;
                } else {
                    heroSection.style.backgroundImage = `linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('${state.hero.backgroundImage}')`;
                }
            }
            
            if (heroTitle) heroTitle.textContent = state.hero.title;
            if (heroDescription) heroDescription.textContent = state.hero.description;
        }

        function renderCategories() {
            const container = document.getElementById('categoriesGrid');
            if (!container) return;

            container.innerHTML = '';

            // Add "All" category
            const allCard = document.createElement('div');
            allCard.className = `category-card ${state.currentCategory === 'all' ? 'active' : ''}`;
            allCard.dataset.category = 'all';
            
            allCard.innerHTML = `
                <div class="category-icon">
                    <i class="fas fa-bars"></i>
                </div>
                <h3 class="category-name">الكل</h3>
                <p class="category-count">${state.products.filter(p => p.status === 'available').length} منتج</p>
            `;
            
            allCard.addEventListener('click', () => {
                state.currentCategory = 'all';
                renderCategoryFilter();
                renderProducts();
                renderCategories();
            });
            
            container.appendChild(allCard);

            // Add other categories
            state.categories.forEach(category => {
                const categoryCard = document.createElement('div');
                categoryCard.className = `category-card ${state.currentCategory === category.name ? 'active' : ''}`;
                categoryCard.dataset.category = category.name;
                
                categoryCard.innerHTML = `
                    <div class="category-icon">
                        <i class="${category.icon}"></i>
                    </div>
                    <h3 class="category-name">${category.name}</h3>
                    <p class="category-count">${category.productCount} منتج</p>
                `;
                
                categoryCard.addEventListener('click', () => {
                    state.currentCategory = category.name;
                    renderCategoryFilter();
                    renderProducts();
                    renderCategories();
                });
                
                container.appendChild(categoryCard);
            });
        }

        function renderTopProducts() {
            const container = document.getElementById('topProductsGrid');
            if (!container) return;

            container.innerHTML = '';

            if (state.topProducts.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <h3 class="empty-state-title">لا توجد منتجات مميزة</h3>
                        <p class="empty-state-description">أضف منتجات مميزة من لوحة التحكم لجذب المزيد من العملاء</p>
                    </div>
                `;
                return;
            }

            state.topProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'top-product-card';
                
                // Get image from local storage or use URL
                let productImage = product.image;
                const imageKey = `top_product_${product.id}`;
                if (state.images[imageKey] && state.images[imageKey].startsWith('data:')) {
                    productImage = state.images[imageKey];
                }
                
                productCard.innerHTML = `
                    <div class="top-product-image">
                        <img src="${productImage || 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'}" 
                             alt="${product.name}" 
                             loading="lazy">
                        <div class="product-badge" style="background: var(--warning-color);">
                            ⭐ مميز
                        </div>
                    </div>
                    <div class="top-product-content">
                        <h3 class="product-title">${product.name}</h3>
                        <p class="product-description">${product.description}</p>
                        <div class="product-footer">
                            <div class="product-price">${product.price} ${state.settings.currency || 'ريال'}</div>
                            <button class="add-to-cart-btn" data-top-product-id="${product.id}">
                                <i class="fas fa-cart-plus"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                // Add click event to add to cart button
                const addToCartBtn = productCard.querySelector('.add-to-cart-btn');
                addToCartBtn.addEventListener('click', () => addToCartFromTopProduct(product.id));
                
                // Add admin controls if admin is logged in
                if (state.isAdmin) {
                    const adminControls = document.createElement('div');
                    adminControls.className = 'product-badge';
                    adminControls.style.background = 'var(--secondary-color)';
                    adminControls.style.top = '1rem';
                    adminControls.style.left = '1rem';
                    adminControls.style.right = 'auto';
                    adminControls.innerHTML = `
                        <button onclick="editTopProduct(${product.id})" style="background: none; border: none; color: white; cursor: pointer; margin-left: 0.5rem;">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="deleteTopProduct(${product.id})" style="background: none; border: none; color: white; cursor: pointer;">
                            <i class="fas fa-trash"></i>
                        </button>
                    `;
                    productCard.querySelector('.top-product-image').appendChild(adminControls);
                }
                
                container.appendChild(productCard);
            });
        }

        function renderCategoryFilter() {
            const container = document.getElementById('productsFilter');
            if (!container) return;

            container.innerHTML = '';

            // Add "All" filter
            const allFilter = document.createElement('button');
            allFilter.type = 'button';
            allFilter.className = `filter-btn ${state.currentCategory === 'all' ? 'active' : ''}`;
            allFilter.textContent = 'الكل';
            allFilter.addEventListener('click', () => {
                state.currentCategory = 'all';
                renderCategoryFilter();
                renderProducts();
                renderCategories();
            });
            container.appendChild(allFilter);

            // Add category filters
            state.categories.forEach(category => {
                const filterBtn = document.createElement('button');
                filterBtn.type = 'button';
                filterBtn.className = `filter-btn ${state.currentCategory === category.name ? 'active' : ''}`;
                filterBtn.textContent = category.name;
                filterBtn.addEventListener('click', () => {
                    state.currentCategory = category.name;
                    renderCategoryFilter();
                    renderProducts();
                    renderCategories();
                });
                container.appendChild(filterBtn);
            });
        }

        function renderProducts() {
            const container = document.getElementById('productsGrid');
            if (!container) return;

            container.innerHTML = '';

            // Filter products by category
            let filteredProducts = state.products;
            if (state.currentCategory !== 'all') {
                filteredProducts = state.products.filter(product => 
                    product.category === state.currentCategory && product.status === 'available'
                );
            } else {
                filteredProducts = state.products.filter(product => product.status === 'available');
            }

            if (filteredProducts.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1;">
                        <div class="empty-state-icon">
                            <i class="fas fa-box-open"></i>
                        </div>
                        <h3 class="empty-state-title">لا توجد منتجات</h3>
                        <p class="empty-state-description">لا توجد منتجات في هذا التصنيف حالياً</p>
                    </div>
                `;
                return;
            }

            filteredProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                
                // Get image from local storage or use URL
                let productImage = product.image;
                const imageKey = `product_${product.id}`;
                if (state.images[imageKey] && state.images[imageKey].startsWith('data:')) {
                    productImage = state.images[imageKey];
                }
                
                productCard.innerHTML = `
                    ${product.status === 'unavailable' ? '<div class="product-badge" style="background: var(--danger-color);">غير متوفر</div>' : ''}
                    <div class="product-image">
                        <img src="${productImage || 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'}" 
                             alt="${product.name}" 
                             loading="lazy">
                    </div>
                    <div class="product-content">
                        <h3 class="product-title">${product.name}</h3>
                        <p class="product-description">${product.description}</p>
                        <div class="product-footer">
                            <div class="product-price">${product.price} ${state.settings.currency || 'ريال'}</div>
                            <button class="add-to-cart-btn" data-product-id="${product.id}" ${product.status === 'unavailable' ? 'disabled' : ''}>
                                <i class="fas fa-cart-plus"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                // Add click event to add to cart button
                const addToCartBtn = productCard.querySelector('.add-to-cart-btn');
                addToCartBtn.addEventListener('click', () => addToCart(product.id));
                
                // Add admin controls if admin is logged in
                if (state.isAdmin) {
                    const adminControls = document.createElement('div');
                    adminControls.className = 'product-badge';
                    adminControls.style.background = 'var(--secondary-color)';
                    adminControls.style.top = '1rem';
                    adminControls.style.left = '1rem';
                    adminControls.style.right = 'auto';
                    adminControls.innerHTML = `
                        <button onclick="editProduct(${product.id})" style="background: none; border: none; color: white; cursor: pointer; margin-left: 0.5rem;">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="deleteProduct(${product.id})" style="background: none; border: none; color: white; cursor: pointer;">
                            <i class="fas fa-trash"></i>
                        </button>
                    `;
                    productCard.querySelector('.product-image').appendChild(adminControls);
                }
                
                container.appendChild(productCard);
            });
        }

        function renderFooterCategories() {
            const container = document.getElementById('footerCategories');
            if (!container) return;

            container.innerHTML = '';

            // Show only first 8 categories in footer
            const footerCategories = state.categories.slice(0, 8);
            
            footerCategories.forEach(category => {
                const li = document.createElement('li');
                li.innerHTML = `<a href="#categories" onclick="filterByCategory('${category.name}')">${category.name}</a>`;
                container.appendChild(li);
            });
        }

        function filterByCategory(categoryName) {
            state.currentCategory = categoryName;
            renderCategoryFilter();
            renderProducts();
            renderCategories();
            
            // Scroll to products section
            document.getElementById('products').scrollIntoView({ behavior: 'smooth' });
        }

        function updateCategoryCounts() {
            state.categories.forEach(category => {
                category.productCount = state.products.filter(
                    product => product.category === category.name && product.status === 'available'
                ).length;
            });
        }

        function updateSettingsUI() {
            // Update contact info in contact section
            document.getElementById('storePhone').textContent = state.settings.storePhone || DEFAULT_SETTINGS.storePhone;
            document.getElementById('storeAddress').textContent = state.settings.storeAddress || DEFAULT_SETTINGS.storeAddress;
            document.getElementById('storeHours').textContent = state.settings.storeHours || DEFAULT_SETTINGS.storeHours;
            document.getElementById('whatsappNumber').textContent = `واتساب: ${state.settings.whatsappNumber || DEFAULT_SETTINGS.whatsappNumber}`;
            document.getElementById('creamyCashInfo').textContent = `كريمي حاسب: ${state.settings.creamyCash || DEFAULT_SETTINGS.creamyCash}`;
            document.getElementById('storeDescription').textContent = state.settings.storeDescription || DEFAULT_SETTINGS.storeDescription;
            
            // Update links
            document.getElementById('whatsappLink').href = `https://wa.me/${(state.settings.whatsappNumber || DEFAULT_SETTINGS.whatsappNumber).replace('+', '')}`;
            document.getElementById('phoneLink').href = `tel:${state.settings.storePhone || DEFAULT_SETTINGS.storePhone}`;
            
            // Update settings form
            document.getElementById('storeNameInput').value = state.settings.storeName || DEFAULT_SETTINGS.storeName;
            document.getElementById('storePhoneInput').value = state.settings.storePhone || DEFAULT_SETTINGS.storePhone;
            document.getElementById('storeAddressInput').value = state.settings.storeAddress || DEFAULT_SETTINGS.storeAddress;
            document.getElementById('storeHoursInput').value = state.settings.storeHours || DEFAULT_SETTINGS.storeHours;
            document.getElementById('storeDescriptionInput').value = state.settings.storeDescription || DEFAULT_SETTINGS.storeDescription;
            document.getElementById('currencyInput').value = state.settings.currency || DEFAULT_SETTINGS.currency;
            document.getElementById('whatsappNumberInput').value = state.settings.whatsappNumber || DEFAULT_SETTINGS.whatsappNumber;
            document.getElementById('creamyCashInput').value = state.settings.creamyCash || DEFAULT_SETTINGS.creamyCash;
            document.getElementById('googleMapsInput').value = state.settings.googleMaps || DEFAULT_SETTINGS.googleMaps;
            
            // Update hero form
            document.getElementById('heroTitleInput').value = state.hero.title || DEFAULT_HERO.title;
            document.getElementById('heroDescriptionInput').value = state.hero.description || DEFAULT_HERO.description;
            
            // Update hero preview
            const heroPreview = document.getElementById('currentHeroPreview');
            if (heroPreview && state.hero.backgroundImage) {
                if (state.images['hero_background'] && state.images['hero_background'].startsWith('data:')) {
                    heroPreview.style.backgroundImage = `url('${state.images['hero_background']}')`;
                } else {
                    heroPreview.style.backgroundImage = `url('${state.hero.backgroundImage}')`;
                }
            }
            
            // Update currency symbols
            document.getElementById('currencySymbol').textContent = state.settings.currency || 'ريال';
            document.getElementById('topCurrencySymbol').textContent = state.settings.currency || 'ريال';
            
            // Update store name display in admin panel
            document.getElementById('storeNameDisplay').textContent = state.settings.storeName || DEFAULT_SETTINGS.storeName;
            document.getElementById('storePhoneDisplay').textContent = state.settings.storePhone || DEFAULT_SETTINGS.storePhone;
            document.getElementById('storeAddressDisplay').textContent = state.settings.storeAddress || DEFAULT_SETTINGS.storeAddress;
            document.getElementById('storeHoursDisplay').textContent = state.settings.storeHours || DEFAULT_SETTINGS.storeHours;
            document.getElementById('currencyDisplay').textContent = state.settings.currency || DEFAULT_SETTINGS.currency;
        }

        // ===== IMAGE UPLOAD FUNCTIONS =====
        function setupImageUpload(uploadContainerId, previewId, fileInputId) {
            const uploadContainer = document.getElementById(uploadContainerId);
            const preview = document.getElementById(previewId);
            const fileInput = document.getElementById(fileInputId);
            
            if (!uploadContainer || !fileInput) return;
            
            // Click on container to trigger file input
            uploadContainer.addEventListener('click', () => {
                fileInput.click();
            });
            
            // Handle drag and drop
            uploadContainer.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadContainer.style.borderColor = 'var(--primary-color)';
                uploadContainer.style.background = 'var(--gray-200)';
            });
            
            uploadContainer.addEventListener('dragleave', () => {
                uploadContainer.style.borderColor = 'var(--gray-300)';
                uploadContainer.style.background = 'var(--gray-100)';
            });
            
            uploadContainer.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadContainer.style.borderColor = 'var(--gray-300)';
                uploadContainer.style.background = 'var(--gray-100)';
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleImageUpload(files[0], preview, uploadContainerId);
                }
            });
            
            // Handle file selection
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleImageUpload(e.target.files[0], preview, uploadContainerId);
                }
            });
        }

        function handleImageUpload(file, previewElement, containerId) {
            // Check if file is an image
            if (!file.type.match('image.*')) {
                showNotification('الرجاء اختيار ملف صورة فقط', 'error');
                return;
            }
            
            // Check file size (max 5MB)
            if (file.size > 5 * 1024 * 1024) {
                showNotification('حجم الصورة يجب أن يكون أقل من 5 ميجابايت', 'error');
                return;
            }
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                if (previewElement) {
                    previewElement.style.display = 'block';
                    previewElement.querySelector('img').src = e.target.result;
                }
                
                // Store temporary image based on container
                switch(containerId) {
                    case 'heroUploadContainer':
                        state.tempHeroImage = e.target.result;
                        document.getElementById('saveHeroImageBtn').style.display = 'block';
                        break;
                    case 'productUploadContainer':
                        state.tempProductImage = e.target.result;
                        break;
                    case 'topProductUploadContainer':
                        state.tempTopProductImage = e.target.result;
                        break;
                }
            };
            
            reader.onerror = function() {
                showNotification('حدث خطأ في قراءة الصورة', 'error');
            };
            
            reader.readAsDataURL(file);
        }

        function saveHeroImage() {
            if (!state.tempHeroImage) {
                showNotification('لم تقم باختيار صورة', 'warning');
                return;
            }
            
            // Store hero image in images object
            state.images['hero_background'] = state.tempHeroImage;
            state.hero.backgroundImage = state.tempHeroImage;
            
            // Save to localStorage
            saveAllData();
            
            // Update preview
            document.getElementById('currentHeroPreview').style.backgroundImage = `url('${state.tempHeroImage}')`;
            
            // Hide save button
            document.getElementById('saveHeroImageBtn').style.display = 'none';
            
            // Clear temporary data
            state.tempHeroImage = null;
            
            showNotification('تم حفظ صورة الخلفية بنجاح', 'success');
            
            // Update hero section
            renderHero();
        }

        // ===== CART FUNCTIONS =====
        function addToCart(productId) {
            const product = state.products.find(p => p.id === productId);
            if (!product || product.status === 'unavailable') {
                showNotification('هذا المنتج غير متوفر حالياً', 'warning');
                return;
            }

            const existingItem = state.cart.find(item => item.productId === productId);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                state.cart.push({
                    productId: productId,
                    name: product.name,
                    price: product.price,
                    image: product.image,
                    quantity: 1
                });
            }

            saveAllData();
            updateCartUI();
            showNotification(`تمت إضافة ${product.name} إلى السلة`, 'success');
        }

        function addToCartFromTopProduct(productId) {
            const product = state.topProducts.find(p => p.id === productId);
            if (!product) {
                showNotification('هذا المنتج غير متوفر حالياً', 'warning');
                return;
            }

            const existingItem = state.cart.find(item => item.productId === `top_${productId}`);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                state.cart.push({
                    productId: `top_${productId}`,
                    name: product.name,
                    price: product.price,
                    image: product.image,
                    quantity: 1
                });
            }

            saveAllData();
            updateCartUI();
            showNotification(`تمت إضافة ${product.name} إلى السلة`, 'success');
        }

        function updateCartUI() {
            // Update cart count
            const cartCount = state.cart.reduce((total, item) => total + item.quantity, 0);
            document.getElementById('cartCount').textContent = cartCount;

            // Update cart modal content
            const cartItemsContainer = document.getElementById('cartItems');
            const cartTotalPrice = document.getElementById('cartTotalPrice');

            if (cartItemsContainer) {
                cartItemsContainer.innerHTML = '';

                if (state.cart.length === 0) {
                    cartItemsContainer.innerHTML = `
                        <div class="empty-state" style="padding: 2rem 1rem;">
                            <div class="empty-state-icon">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <h3 class="empty-state-title">سلة التسوق فارغة</h3>
                            <p class="empty-state-description">أضف بعض المنتجات إلى سلة التسوق</p>
                        </div>
                    `;
                    cartTotalPrice.textContent = `0 ${state.settings.currency || 'ريال'}`;
                    return;
                }

                let total = 0;

                state.cart.forEach((item, index) => {
                    let product;
                    let isTopProduct = item.productId.toString().startsWith('top_');
                    
                    if (isTopProduct) {
                        const topProductId = parseInt(item.productId.replace('top_', ''));
                        product = state.topProducts.find(p => p.id === topProductId);
                    } else {
                        product = state.products.find(p => p.id === item.productId);
                    }
                    
                    if (!product) return;

                    total += item.price * item.quantity;

                    const cartItem = document.createElement('div');
                    cartItem.className = 'cart-item';
                    
                    // Get image from local storage or use URL
                    let productImage = item.image;
                    const imageKey = isTopProduct ? `top_product_${product.id}` : `product_${product.id}`;
                    if (state.images[imageKey] && state.images[imageKey].startsWith('data:')) {
                        productImage = state.images[imageKey];
                    }
                    
                    cartItem.innerHTML = `
                        <div class="cart-item-image">
                            <img src="${productImage || 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'}" 
                                 alt="${item.name}">
                        </div>
                        <div class="cart-item-details">
                            <h4 class="cart-item-title">${item.name}</h4>
                            <p class="cart-item-price">${item.price} ${state.settings.currency || 'ريال'}</p>
                            <div class="cart-item-actions">
                                <button class="quantity-btn" onclick="updateCartQuantity(${index}, ${item.quantity - 1})" ${item.quantity <= 1 ? 'disabled' : ''}>
                                    <i class="fas fa-minus"></i>
                                </button>
                                <span class="cart-item-quantity">${item.quantity}</span>
                                <button class="quantity-btn" onclick="updateCartQuantity(${index}, ${item.quantity + 1})">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button class="quantity-btn" onclick="removeFromCart(${index})" style="color: var(--danger-color);">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `;
                    cartItemsContainer.appendChild(cartItem);
                });

                cartTotalPrice.textContent = `${total} ${state.settings.currency || 'ريال'}`;
            }
        }

        function updateCartQuantity(index, newQuantity) {
            if (newQuantity < 1) {
                state.cart.splice(index, 1);
            } else {
                state.cart[index].quantity = newQuantity;
            }
            saveAllData();
            updateCartUI();
        }

        function removeFromCart(index) {
            const itemName = state.cart[index].name;
            state.cart.splice(index, 1);
            saveAllData();
            updateCartUI();
            showNotification(`تم حذف ${itemName} من السلة`, 'success');
        }

        function checkout() {
            if (state.cart.length === 0) {
                showNotification('سلة التسوق فارغة', 'warning');
                return;
            }

            // Calculate total
            const total = state.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            // Create WhatsApp message
            let message = `*طلب جديد من كافتيريا الخير*%0A%0A`;
            message += `*تفاصيل الطلب:*%0A`;
            message += `────────────%0A`;
            
            state.cart.forEach((item, index) => {
                message += `${index + 1}. ${item.name}%0A`;
                message += `   الكمية: ${item.quantity} × ${item.price} = ${item.quantity * item.price} ${state.settings.currency}%0A`;
            });
            
            message += `────────────%0A`;
            message += `*المجموع: ${total} ${state.settings.currency}*%0A%0A`;
            message += `*معلومات العميل:*%0A`;
            message += `────────────%0A`;
            message += `الاسم: ________%0A`;
            message += `رقم الهاتف: ________%0A`;
            message += `العنوان: ________%0A`;
            message += `ملاحظات: ________%0A%0A`;
            message += `*طرق الدفع:*%0A`;
            message += `1. نقداً عند الاستلام%0A`;
            message += `2. تحويل بنكي عبر كريمي حاسب%0A`;
            message += `   رقم نقطة حاسب: ${state.settings.creamyCash || DEFAULT_SETTINGS.creamyCash}%0A%0A`;
            message += `شكراً لثقتكم بكافتيريا الخير! 🍹`;
            
            // Create order
            const order = {
                id: Date.now(),
                items: [...state.cart],
                total: total,
                status: 'pending',
                date: new Date().toISOString(),
                customerName: 'قيد الانتظار',
                customerPhone: 'قيد الانتظار',
                customerAddress: 'قيد الانتظار',
                notes: ''
            };

            state.orders.push(order);
            state.cart = [];

            saveAllData();
            updateCartUI();
            updateAdminStats();
            
            // Close cart modal
            document.getElementById('cartModal').classList.remove('active');
            
            // Open WhatsApp with the message
            const phoneNumber = state.settings.whatsappNumber || DEFAULT_SETTINGS.whatsappNumber;
            const whatsappUrl = `https://wa.me/${phoneNumber.replace('+', '')}?text=${message}`;
            window.open(whatsappUrl, '_blank');
            
            showNotification(`تم إنشاء الطلب بنجاح! رقم الطلب: ${order.id}`, 'success');
        }

        // ===== ADMIN FUNCTIONS =====
        function updateAdminUI() {
            const adminBtn = document.getElementById('adminFloatingBtn');
            if (adminBtn) {
                if (state.isAdmin) {
                    adminBtn.classList.add('show');
                    adminBtn.setAttribute('title', 'لوحة التحكم');
                } else {
                    adminBtn.classList.remove('show');
                }
            }
        }

        function loginAdmin(username, password) {
            if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                state.isAdmin = true;
                localStorage.setItem(STORAGE_KEYS.ADMIN_TOKEN, 'logged_in');
                updateAdminUI();
                document.getElementById('loginModal').classList.remove('active');
                showNotification('تم تسجيل الدخول بنجاح كمسؤول', 'success');
                return true;
            } else {
                showNotification('اسم المستخدم أو كلمة المرور غير صحيحة', 'error');
                return false;
            }
        }

        function logoutAdmin() {
            state.isAdmin = false;
            localStorage.removeItem(STORAGE_KEYS.ADMIN_TOKEN);
            updateAdminUI();
            document.getElementById('adminPanel').classList.remove('active');
            showNotification('تم تسجيل الخروج بنجاح', 'success');
        }

        function switchAdminTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.admin-tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.admin-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(`${tabName}Tab`).classList.add('active');
            
            // Activate selected tab button
            const tabBtn = document.querySelector(`.admin-tab[data-tab="${tabName}"]`);
            if (tabBtn) {
                tabBtn.classList.add('active');
            }
            
            // Load tab content if needed
            switch(tabName) {
                case 'hero':
                    loadHeroForm();
                    break;
                case 'top-products':
                    loadTopProductsList();
                    break;
                case 'products':
                    loadProductsList();
                    break;
                case 'categories':
                    loadCategoriesList();
                    break;
                case 'orders':
                    loadOrdersList();
                    break;
                case 'settings':
                    loadSettingsForm();
                    break;
            }
        }

        function updateAdminStats() {
            document.getElementById('statProducts').textContent = state.products.length + state.topProducts.length;
            document.getElementById('statCategories').textContent = state.categories.length;
            
            const todayOrders = state.orders.filter(order => {
                const orderDate = new Date(order.date);
                const today = new Date();
                return orderDate.toDateString() === today.toDateString();
            });
            document.getElementById('statOrders').textContent = todayOrders.length;
            
            const totalRevenue = state.orders.reduce((sum, order) => sum + order.total, 0);
            document.getElementById('statRevenue').textContent = `${totalRevenue} ${state.settings.currency || 'ريال'}`;
        }

        function loadHeroForm() {
            const heroTitleInput = document.getElementById('heroTitleInput');
            const heroDescriptionInput = document.getElementById('heroDescriptionInput');
            
            if (heroTitleInput) heroTitleInput.value = state.hero.title || DEFAULT_HERO.title;
            if (heroDescriptionInput) heroDescriptionInput.value = state.hero.description || DEFAULT_HERO.description;
            
            // Show current hero background
            const currentHeroPreview = document.getElementById('currentHeroPreview');
            if (currentHeroPreview && state.hero.backgroundImage) {
                if (state.images['hero_background'] && state.images['hero_background'].startsWith('data:')) {
                    currentHeroPreview.style.backgroundImage = `url('${state.images['hero_background']}')`;
                } else {
                    currentHeroPreview.style.backgroundImage = `url('${state.hero.backgroundImage}')`;
                }
            }
            
            // Clear temporary data
            state.tempHeroImage = null;
            document.getElementById('saveHeroImageBtn').style.display = 'none';
            document.getElementById('heroImagePreview').style.display = 'none';
        }

        function saveHeroSettings() {
            const heroTitle = document.getElementById('heroTitleInput').value.trim();
            const heroDescription = document.getElementById('heroDescriptionInput').value.trim();
            
            if (!heroTitle || !heroDescription) {
                showNotification('يرجى ملء جميع الحقول المطلوبة', 'error');
                return;
            }
            
            state.hero.title = heroTitle;
            state.hero.description = heroDescription;
            
            // If there's a new hero image, save it
            if (state.tempHeroImage) {
                state.images['hero_background'] = state.tempHeroImage;
                state.hero.backgroundImage = state.tempHeroImage;
                state.tempHeroImage = null;
                document.getElementById('saveHeroImageBtn').style.display = 'none';
            }
            
            saveAllData();
            renderHero();
            showNotification('تم حفظ إعدادات الصفحة الرئيسية بنجاح', 'success');
        }

        function resetHeroSettings() {
            if (confirm('هل أنت متأكد من إعادة تعيين إعدادات الصفحة الرئيسية؟')) {
                state.hero = { ...DEFAULT_HERO };
                state.images['hero_background'] = DEFAULT_HERO.backgroundImage;
                saveAllData();
                loadHeroForm();
                renderHero();
                showNotification('تم إعادة تعيين إعدادات الصفحة الرئيسية', 'success');
            }
        }

        function loadProductsList() {
            const container = document.getElementById('productsList');
            if (!container) return;

            container.innerHTML = '';

            if (state.products.length === 0) {
                container.innerHTML = '<p class="empty-state">لا توجد منتجات</p>';
                return;
            }

            // Sort products by date (newest first)
            const sortedProducts = [...state.products].sort((a, b) => 
                new Date(b.createdAt) - new Date(a.createdAt)
            );

            sortedProducts.forEach(product => {
                const productItem = document.createElement('div');
                productItem.className = 'cart-item';
                productItem.style.marginBottom = '0.5rem';
                productItem.style.background = 'white';
                productItem.style.borderRadius = 'var(--radius)';
                productItem.style.padding = '0.75rem';
                
                // Get image from local storage or use URL
                let productImage = product.image;
                const imageKey = `product_${product.id}`;
                if (state.images[imageKey] && state.images[imageKey].startsWith('data:')) {
                    productImage = state.images[imageKey];
                }
                
                productItem.innerHTML = `
                    <div class="cart-item-image">
                        <img src="${productImage || 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'}" 
                             alt="${product.name}">
                    </div>
                    <div class="cart-item-details">
                        <h4 class="cart-item-title">${product.name}</h4>
                        <p style="color: var(--gray-600); margin-bottom: 0.25rem;">${product.category} • ${product.price} ${state.settings.currency || 'ريال'}</p>
                        <p style="color: var(--gray-500); font-size: 0.875rem;">${product.description.substring(0, 60)}...</p>
                        <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                            <span class="product-badge" style="font-size: 0.75rem; padding: 0.25rem 0.5rem; background: ${product.status === 'available' ? 'var(--primary-color)' : 'var(--danger-color)'}">
                                ${product.status === 'available' ? 'متوفر' : 'غير متوفر'}
                            </span>
                        </div>
                    </div>
                    <div class="cart-item-actions">
                        <button class="btn btn-sm btn-secondary" onclick="editProduct(${product.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteProduct(${product.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(productItem);
            });
        }

        function loadTopProductsList() {
            const container = document.getElementById('topProductsList');
            if (!container) return;

            container.innerHTML = '';

            if (state.topProducts.length === 0) {
                container.innerHTML = '<p class="empty-state">لا توجد منتجات مميزة</p>';
                return;
            }

            state.topProducts.forEach(product => {
                const productItem = document.createElement('div');
                productItem.className = 'cart-item';
                productItem.style.marginBottom = '0.5rem';
                productItem.style.background = 'white';
                productItem.style.borderRadius = 'var(--radius)';
                productItem.style.padding = '0.75rem';
                
                // Get image from local storage or use URL
                let productImage = product.image;
                const imageKey = `top_product_${product.id}`;
                if (state.images[imageKey] && state.images[imageKey].startsWith('data:')) {
                    productImage = state.images[imageKey];
                }
                
                productItem.innerHTML = `
                    <div class="cart-item-image">
                        <img src="${productImage || 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'}" 
                             alt="${product.name}">
                    </div>
                    <div class="cart-item-details">
                        <h4 class="cart-item-title">${product.name}</h4>
                        <p style="color: var(--gray-600); margin-bottom: 0.25rem;">${product.price} ${state.settings.currency || 'ريال'}</p>
                        <p style="color: var(--gray-500); font-size: 0.875rem;">${product.description.substring(0, 60)}...</p>
                        <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                            <span class="product-badge" style="font-size: 0.75rem; padding: 0.25rem 0.5rem; background: var(--warning-color);">
                                ⭐ مميز
                            </span>
                        </div>
                    </div>
                    <div class="cart-item-actions">
                        <button class="btn btn-sm btn-secondary" onclick="editTopProduct(${product.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteTopProduct(${product.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(productItem);
            });
        }

        function loadCategoriesList() {
            const container = document.getElementById('categoriesList');
            if (!container) return;

            container.innerHTML = '';

            if (state.categories.length === 0) {
                container.innerHTML = '<p class="empty-state">لا توجد تصنيفات</p>';
                return;
            }

            state.categories.forEach(category => {
                const categoryItem = document.createElement('div');
                categoryItem.className = 'cart-item';
                categoryItem.style.marginBottom = '0.5rem';
                categoryItem.style.background = 'white';
                categoryItem.style.borderRadius = 'var(--radius)';
                categoryItem.style.padding = '0.75rem';
                
                categoryItem.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 1rem;">
                        <div class="category-icon" style="width: 40px; height: 40px; font-size: 1rem;">
                            <i class="${category.icon}"></i>
                        </div>
                        <div>
                            <h4 style="margin: 0; font-size: 1rem;">${category.name}</h4>
                            <p style="color: var(--gray-600); margin: 0; font-size: 0.875rem;">${category.productCount} منتج</p>
                        </div>
                    </div>
                    <div class="cart-item-actions">
                        <button class="btn btn-sm btn-danger" onclick="deleteCategory(${category.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(categoryItem);
            });
        }

        function loadOrdersList() {
            const container = document.getElementById('ordersList');
            if (!container) return;

            container.innerHTML = '';

            if (state.orders.length === 0) {
                container.innerHTML = '<p class="empty-state">لا توجد طلبات</p>';
                return;
            }

            // Show recent orders (last 10)
            const recentOrders = [...state.orders]
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 10);

            recentOrders.forEach(order => {
                const orderItem = document.createElement('div');
                orderItem.className = 'cart-item';
                orderItem.style.marginBottom = '1rem';
                orderItem.style.cursor = 'pointer';
                orderItem.style.background = 'white';
                orderItem.style.borderRadius = 'var(--radius)';
                orderItem.style.padding = '0.75rem';
                
                const date = new Date(order.date);
                const formattedDate = date.toLocaleDateString('ar-SA', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                let statusColor = 'var(--warning-color)';
                let statusText = 'قيد الانتظار';
                
                if (order.status === 'completed') {
                    statusColor = 'var(--primary-color)';
                    statusText = 'مكتمل';
                } else if (order.status === 'cancelled') {
                    statusColor = 'var(--danger-color)';
                    statusText = 'ملغي';
                }
                
                orderItem.innerHTML = `
                    <div style="flex: 1;" onclick="showOrderDetails(${order.id})">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <h4 style="margin: 0; font-size: 1rem;">طلب #${order.id}</h4>
                            <span style="background: ${statusColor}; color: white; padding: 0.25rem 0.75rem; border-radius: 50px; font-size: 0.75rem;">
                                ${statusText}
                            </span>
                        </div>
                        <p style="color: var(--gray-600); margin: 0 0 0.5rem 0; font-size: 0.875rem;">
                            ${formattedDate}
                        </p>
                        <p style="color: var(--gray-600); margin: 0; font-size: 0.875rem;">
                            ${order.items.length} منتج • ${order.total} ${state.settings.currency || 'ريال'}
                        </p>
                        <div style="margin-top: 0.5rem;">
                            ${order.items.map(item => 
                                `<span style="display: inline-block; background: var(--gray-100); padding: 0.25rem 0.5rem; border-radius: var(--radius-sm); margin-left: 0.25rem; font-size: 0.75rem;">
                                    ${item.name} (${item.quantity})
                                </span>`
                            ).join('')}
                        </div>
                    </div>
                `;
                container.appendChild(orderItem);
            });
        }

        function loadSettingsForm() {
            // This function is already called in updateSettingsUI()
        }

        function saveSettings() {
            const storeName = document.getElementById('storeNameInput').value.trim();
            const storePhone = document.getElementById('storePhoneInput').value.trim();
            const storeAddress = document.getElementById('storeAddressInput').value.trim();
            const storeHours = document.getElementById('storeHoursInput').value.trim();
            const storeDescription = document.getElementById('storeDescriptionInput').value.trim();
            const currency = document.getElementById('currencyInput').value;
            const whatsappNumber = document.getElementById('whatsappNumberInput').value.trim();
            const creamyCash = document.getElementById('creamyCashInput').value.trim();
            const googleMaps = document.getElementById('googleMapsInput').value.trim();
            
            if (!storeName || !storePhone || !storeAddress) {
                showNotification('يرجى ملء الحقول المطلوبة (اسم المتجر، الهاتف، العنوان)', 'error');
                return;
            }
            
            state.settings = {
                storeName,
                storePhone,
                storeAddress,
                storeHours,
                storeDescription,
                currency,
                whatsappNumber,
                creamyCash,
                googleMaps: googleMaps || DEFAULT_SETTINGS.googleMaps
            };
            
            saveAllData();
            updateSettingsUI();
            renderAll();
            showNotification('تم حفظ الإعدادات بنجاح', 'success');
        }

        function resetSettings() {
            if (confirm('هل أنت متأكد من إعادة تعيين جميع الإعدادات؟ سيتم فقدان جميع التغييرات.')) {
                state.settings = { ...DEFAULT_SETTINGS };
                saveAllData();
                updateSettingsUI();
                renderAll();
                showNotification('تم إعادة تعيين جميع الإعدادات', 'success');
            }
        }

        // ===== PRODUCT MANAGEMENT =====
        function addProduct() {
            resetProductForm();
            document.getElementById('productFormTitle').textContent = '➕ إضافة منتج جديد';
            
            // Load categories into select
            const categorySelect = document.getElementById('productCategoryInput');
            categorySelect.innerHTML = '<option value="">اختر التصنيف</option>';
            state.categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.name;
                option.textContent = category.name;
                categorySelect.appendChild(option);
            });
            
            document.getElementById('productFormModal').classList.add('active');
        }

        function editProduct(productId) {
            const product = state.products.find(p => p.id === productId);
            if (!product) return;
            
            state.currentProductId = productId;
            
            document.getElementById('productFormTitle').textContent = '✏️ تعديل المنتج';
            document.getElementById('productId').value = productId;
            document.getElementById('productNameInput').value = product.name;
            document.getElementById('productDescriptionInput').value = product.description;
            document.getElementById('productPriceInput').value = product.price;
            document.getElementById('productStatusInput').value = product.status;
            
            // Load categories into select
            const categorySelect = document.getElementById('productCategoryInput');
            categorySelect.innerHTML = '<option value="">اختر التصنيف</option>';
            state.categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.name;
                option.textContent = category.name;
                if (category.name === product.category) {
                    option.selected = true;
                }
                categorySelect.appendChild(option);
            });
            
            // Show product image preview if exists
            const imageKey = `product_${productId}`;
            if (state.images[imageKey] && state.images[imageKey].startsWith('data:')) {
                const preview = document.getElementById('productImagePreview');
                preview.style.display = 'block';
                preview.querySelector('img').src = state.images[imageKey];
            }
            
            document.getElementById('productFormModal').classList.add('active');
        }

        function saveProduct() {
            const productId = document.getElementById('productId').value;
            const name = document.getElementById('productNameInput').value.trim();
            const description = document.getElementById('productDescriptionInput').value.trim();
            const price = parseInt(document.getElementById('productPriceInput').value);
            const category = document.getElementById('productCategoryInput').value;
            const status = document.getElementById('productStatusInput').value;
            
            if (!name || !description || !price || !category) {
                showNotification('يرجى ملء جميع الحقول المطلوبة', 'error');
                return;
            }
            
            if (price < 0) {
                showNotification('السعر يجب أن يكون رقم موجب', 'error');
                return;
            }
            
            if (productId) {
                // Update existing product
                const index = state.products.findIndex(p => p.id === parseInt(productId));
                if (index !== -1) {
                    const oldCategory = state.products[index].category;
                    
                    state.products[index] = {
                        ...state.products[index],
                        name,
                        description,
                        price,
                        category,
                        status,
                        updatedAt: new Date().toISOString()
                    };
                    
                    // Save image if uploaded
                    if (state.tempProductImage) {
                        const imageKey = `product_${productId}`;
                        state.images[imageKey] = state.tempProductImage;
                        state.products[index].image = state.tempProductImage;
                        state.tempProductImage = null;
                    }
                    
                    // Update category counts if category changed
                    if (oldCategory !== category) {
                        updateCategoryCounts();
                    }
                }
            } else {
                // Add new product
                const newProduct = {
                    id: Date.now(),
                    name,
                    description,
                    price,
                    category,
                    status,
                    image: state.tempProductImage || 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
                    createdAt: new Date().toISOString()
                };
                
                state.products.push(newProduct);
                
                // Save image if uploaded
                if (state.tempProductImage) {
                    const imageKey = `product_${newProduct.id}`;
                    state.images[imageKey] = state.tempProductImage;
                    state.tempProductImage = null;
                }
                
                // Update category counts
                updateCategoryCounts();
            }
            
            saveAllData();
            renderAll();
            document.getElementById('productFormModal').classList.remove('active');
            showNotification(productId ? 'تم تحديث المنتج بنجاح' : 'تم إضافة المنتج بنجاح', 'success');
        }

        function resetProductForm() {
            state.currentProductId = null;
            state.tempProductImage = null;
            document.getElementById('productForm').reset();
            document.getElementById('productId').value = '';
            document.getElementById('productImagePreview').style.display = 'none';
        }

        function deleteProduct(productId) {
            if (confirm('هل أنت متأكد من حذف هذا المنتج؟')) {
                const index = state.products.findIndex(p => p.id === productId);
                if (index !== -1) {
                    const productName = state.products[index].name;
                    const productCategory = state.products[index].category;
                    
                    state.products.splice(index, 1);
                    
                    // Remove product image from storage
                    const imageKey = `product_${productId}`;
                    if (state.images[imageKey]) {
                        delete state.images[imageKey];
                    }
                    
                    // Update category counts
                    updateCategoryCounts();
                    
                    saveAllData();
                    renderAll();
                    showNotification(`تم حذف المنتج "${productName}" بنجاح`, 'success');
                }
            }
        }

        // ===== TOP PRODUCT MANAGEMENT =====
        function addTopProduct() {
            resetTopProductForm();
            document.getElementById('topProductFormTitle').textContent = '➕ إضافة منتج مميز';
            document.getElementById('topProductFormModal').classList.add('active');
        }

        function editTopProduct(productId) {
            const product = state.topProducts.find(p => p.id === productId);
            if (!product) return;
            
            state.currentTopProductId = productId;
            
            document.getElementById('topProductFormTitle').textContent = '✏️ تعديل المنتج المميز';
            document.getElementById('topProductId').value = productId;
            document.getElementById('topProductNameInput').value = product.name;
            document.getElementById('topProductDescriptionInput').value = product.description;
            document.getElementById('topProductPriceInput').value = product.price;
            
            // Show product image preview if exists
            const imageKey = `top_product_${productId}`;
            if (state.images[imageKey] && state.images[imageKey].startsWith('data:')) {
                const preview = document.getElementById('topProductImagePreview');
                preview.style.display = 'block';
                preview.querySelector('img').src = state.images[imageKey];
            }
            
            document.getElementById('topProductFormModal').classList.add('active');
        }

        function saveTopProduct() {
            const productId = document.getElementById('topProductId').value;
            const name = document.getElementById('topProductNameInput').value.trim();
            const description = document.getElementById('topProductDescriptionInput').value.trim();
            const price = parseInt(document.getElementById('topProductPriceInput').value);
            
            if (!name || !description || !price) {
                showNotification('يرجى ملء جميع الحقول المطلوبة', 'error');
                return;
            }
            
            if (price < 0) {
                showNotification('السعر يجب أن يكون رقم موجب', 'error');
                return;
            }
            
            if (productId) {
                // Update existing top product
                const index = state.topProducts.findIndex(p => p.id === parseInt(productId));
                if (index !== -1) {
                    state.topProducts[index] = {
                        ...state.topProducts[index],
                        name,
                        description,
                        price,
                        updatedAt: new Date().toISOString()
                    };
                    
                    // Save image if uploaded
                    if (state.tempTopProductImage) {
                        const imageKey = `top_product_${productId}`;
                        state.images[imageKey] = state.tempTopProductImage;
                        state.topProducts[index].image = state.tempTopProductImage;
                        state.tempTopProductImage = null;
                    }
                }
            } else {
                // Add new top product
                const newProduct = {
                    id: Date.now(),
                    name,
                    description,
                    price,
                    image: state.tempTopProductImage || 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
                    createdAt: new Date().toISOString()
                };
                
                state.topProducts.push(newProduct);
                
                // Save image if uploaded
                if (state.tempTopProductImage) {
                    const imageKey = `top_product_${newProduct.id}`;
                    state.images[imageKey] = state.tempTopProductImage;
                    state.tempTopProductImage = null;
                }
            }
            
            saveAllData();
            renderAll();
            document.getElementById('topProductFormModal').classList.remove('active');
            showNotification(productId ? 'تم تحديث المنتج المميز بنجاح' : 'تم إضافة المنتج المميز بنجاح', 'success');
        }

        function resetTopProductForm() {
            state.currentTopProductId = null;
            state.tempTopProductImage = null;
            document.getElementById('topProductForm').reset();
            document.getElementById('topProductId').value = '';
            document.getElementById('topProductImagePreview').style.display = 'none';
        }

        function deleteTopProduct(productId) {
            if (confirm('هل أنت متأكد من حذف هذا المنتج المميز؟')) {
                const index = state.topProducts.findIndex(p => p.id === productId);
                if (index !== -1) {
                    const productName = state.topProducts[index].name;
                    state.topProducts.splice(index, 1);
                    
                    // Remove product image from storage
                    const imageKey = `top_product_${productId}`;
                    if (state.images[imageKey]) {
                        delete state.images[imageKey];
                    }
                    
                    saveAllData();
                    renderAll();
                    showNotification(`تم حذف المنتج المميز "${productName}" بنجاح`, 'success');
                }
            }
        }

        // ===== CATEGORY MANAGEMENT =====
        function addCategory() {
            resetCategoryForm();
            document.getElementById('categoryFormTitle').textContent = '➕ إضافة تصنيف جديد';
            document.getElementById('categoryFormModal').classList.add('active');
        }

        function saveCategory() {
            const categoryId = document.getElementById('categoryId').value;
            const name = document.getElementById('categoryNameInput').value.trim();
            const icon = document.getElementById('categoryIconInput').value;
            
            if (!name || !icon) {
                showNotification('يرجى ملء جميع الحقول المطلوبة', 'error');
                return;
            }
            
            if (categoryId) {
                // Update existing category
                const index = state.categories.findIndex(c => c.id === parseInt(categoryId));
                if (index !== -1) {
                    const oldName = state.categories[index].name;
                    state.categories[index] = {
                        ...state.categories[index],
                        name,
                        icon
                    };
                    
                    // Update product categories if name changed
                    if (oldName !== name) {
                        state.products.forEach(product => {
                            if (product.category === oldName) {
                                product.category = name;
                            }
                        });
                        updateCategoryCounts();
                    }
                }
            } else {
                // Add new category
                const newCategory = {
                    id: Date.now(),
                    name,
                    icon,
                    productCount: 0
                };
                state.categories.push(newCategory);
            }
            
            saveAllData();
            renderAll();
            document.getElementById('categoryFormModal').classList.remove('active');
            showNotification(categoryId ? 'تم تحديث التصنيف بنجاح' : 'تم إضافة التصنيف بنجاح', 'success');
        }

        function resetCategoryForm() {
            document.getElementById('categoryId').value = '';
            document.getElementById('categoryNameInput').value = '';
            document.getElementById('categoryIconInput').value = 'fas fa-glass-whiskey';
        }

        function deleteCategory(categoryId) {
            if (confirm('هل أنت متأكد من حذف هذا التصنيف؟ سيتم حذف جميع المنتجات فيه.')) {
                const index = state.categories.findIndex(c => c.id === categoryId);
                if (index !== -1) {
                    const categoryName = state.categories[index].name;
                    
                    // Remove products in this category
                    state.products = state.products.filter(p => p.category !== categoryName);
                    
                    // Remove category
                    state.categories.splice(index, 1);
                    
                    saveAllData();
                    updateCategoryCounts();
                    renderAll();
                    showNotification(`تم حذف التصنيف "${categoryName}" وجميع منتجاته`, 'success');
                }
            }
        }

        // ===== ORDER MANAGEMENT =====
        function showOrderDetails(orderId) {
            const order = state.orders.find(o => o.id === orderId);
            if (!order) return;
            
            state.currentOrderId = orderId;
            
            const date = new Date(order.date);
            const formattedDate = date.toLocaleDateString('ar-SA', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            let statusColor = 'var(--warning-color)';
            let statusText = 'قيد الانتظار';
            
            if (order.status === 'completed') {
                statusColor = 'var(--primary-color)';
                statusText = 'مكتمل';
            } else if (order.status === 'cancelled') {
                statusColor = 'var(--danger-color)';
                statusText = 'ملغي';
            }
            
            let itemsHTML = '';
            order.items.forEach((item, index) => {
                itemsHTML += `
                    <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--gray-200);">
                        <div>
                            <strong>${index + 1}. ${item.name}</strong>
                            <div style="color: var(--gray-600); font-size: 0.875rem;">الكمية: ${item.quantity} × ${item.price} ${state.settings.currency}</div>
                        </div>
                        <div style="font-weight: 600;">${item.price * item.quantity} ${state.settings.currency}</div>
                    </div>
                `;
            });
            
            document.getElementById('orderDetailsId').textContent = orderId;
            document.getElementById('orderDetailsContent').innerHTML = `
                <div style="margin-bottom: 1.5rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
                        <div>
                            <strong>رقم الطلب:</strong> ${order.id}
                        </div>
                        <span style="background: ${statusColor}; color: white; padding: 0.25rem 0.75rem; border-radius: 50px; font-size: 0.875rem;">
                            ${statusText}
                        </span>
                    </div>
                    <div style="color: var(--gray-600); margin-bottom: 1rem;">${formattedDate}</div>
                </div>
                
                <div style="margin-bottom: 1.5rem;">
                    <h4 style="margin-bottom: 0.5rem;">معلومات العميل</h4>
                    <div style="background: var(--gray-100); padding: 1rem; border-radius: var(--radius);">
                        <div><strong>الاسم:</strong> ${order.customerName}</div>
                        <div><strong>الهاتف:</strong> ${order.customerPhone}</div>
                        <div><strong>العنوان:</strong> ${order.customerAddress}</div>
                        ${order.notes ? `<div><strong>ملاحظات:</strong> ${order.notes}</div>` : ''}
                    </div>
                </div>
                
                <div style="margin-bottom: 1.5rem;">
                    <h4 style="margin-bottom: 0.5rem;">تفاصيل الطلب</h4>
                    ${itemsHTML}
                </div>
                
                <div style="display: flex; justify-content: space-between; font-size: 1.25rem; font-weight: 700; padding-top: 1rem; border-top: 2px solid var(--gray-300);">
                    <span>الإجمالي:</span>
                    <span>${order.total} ${state.settings.currency}</span>
                </div>
            `;
            
            // Show/hide action buttons based on order status
            const cancelBtn = document.getElementById('cancelOrderBtn');
            const completeBtn = document.getElementById('completeOrderBtn');
            
            if (order.status === 'completed' || order.status === 'cancelled') {
                cancelBtn.style.display = 'none';
                completeBtn.style.display = 'none';
            } else {
                cancelBtn.style.display = 'inline-flex';
                completeBtn.style.display = 'inline-flex';
            }
            
            document.getElementById('orderDetailsModal').classList.add('active');
        }

        function updateOrderStatus(status) {
            const orderId = state.currentOrderId;
            const orderIndex = state.orders.findIndex(o => o.id === orderId);
            
            if (orderIndex !== -1) {
                state.orders[orderIndex].status = status;
                saveAllData();
                loadOrdersList();
                document.getElementById('orderDetailsModal').classList.remove('active');
                
                const statusText = status === 'completed' ? 'مكتمل' : 'ملغي';
                showNotification(`تم تحديث حالة الطلب #${orderId} إلى ${statusText}`, 'success');
            }
        }

        // ===== UTILITY FUNCTIONS =====
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="notification-icon">
                    ${type === 'success' ? '✓' : type === 'error' ? '✗' : '⚠'}
                </div>
                <div>${message}</div>
            `;
            
            container.appendChild(notification);
            
            // Show notification
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            
            // Remove notification after 5 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 5000);
        }

        function showLoading() {
            document.getElementById('loadingOverlay').classList.add('active');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.remove('active');
        }

        // ===== EVENT LISTENERS SETUP =====
        function setupEventListeners() {
            // Cart button
            document.getElementById('cartButton').addEventListener('click', () => {
                document.getElementById('cartModal').classList.add('active');
            });

            // Close cart modal
            document.getElementById('closeCartModal').addEventListener('click', () => {
                document.getElementById('cartModal').classList.remove('active');
            });

            // Checkout button
            document.getElementById('checkoutBtn').addEventListener('click', checkout);

            // Start order button
            document.getElementById('startOrderBtn').addEventListener('click', () => {
                document.getElementById('products').scrollIntoView({ behavior: 'smooth' });
            });

            // Admin floating button
            document.getElementById('adminFloatingBtn').addEventListener('click', () => {
                if (state.isAdmin) {
                    document.getElementById('adminPanel').classList.add('active');
                    switchAdminTab('stats');
                } else {
                    document.getElementById('loginModal').classList.add('active');
                }
            });

            // Login modal
            document.getElementById('loginBtn').addEventListener('click', () => {
                const username = document.getElementById('adminUsername').value;
                const password = document.getElementById('adminPassword').value;
                if (username && password) {
                    loginAdmin(username, password);
                } else {
                    showNotification('يرجى إدخال اسم المستخدم وكلمة المرور', 'warning');
                }
            });

            document.getElementById('cancelLoginBtn').addEventListener('click', () => {
                document.getElementById('loginModal').classList.remove('active');
            });

            document.getElementById('closeLoginModal').addEventListener('click', () => {
                document.getElementById('loginModal').classList.remove('active');
            });

            // Admin panel
            document.getElementById('closeAdminPanel').addEventListener('click', () => {
                document.getElementById('adminPanel').classList.remove('active');
            });

            document.getElementById('logoutBtn').addEventListener('click', logoutAdmin);

            // Admin tabs
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.getAttribute('data-tab');
                    switchAdminTab(tabName);
                });
            });

            // Hero settings
            document.getElementById('saveHeroBtn').addEventListener('click', saveHeroSettings);
            document.getElementById('resetHeroBtn').addEventListener('click', resetHeroSettings);
            document.getElementById('saveHeroImageBtn').addEventListener('click', saveHeroImage);

            // Settings
            document.getElementById('saveSettingsBtn').addEventListener('click', saveSettings);
            document.getElementById('resetSettingsBtn').addEventListener('click', resetSettings);

            // Product management
            document.getElementById('addProductBtn').addEventListener('click', addProduct);
            document.getElementById('saveProductBtn').addEventListener('click', saveProduct);
            document.getElementById('cancelProductBtn').addEventListener('click', () => {
                document.getElementById('productFormModal').classList.remove('active');
            });
            document.getElementById('closeProductForm').addEventListener('click', () => {
                document.getElementById('productFormModal').classList.remove('active');
            });

            // Top product management
            document.getElementById('addTopProductBtn').addEventListener('click', addTopProduct);
            document.getElementById('saveTopProductBtn').addEventListener('click', saveTopProduct);
            document.getElementById('cancelTopProductBtn').addEventListener('click', () => {
                document.getElementById('topProductFormModal').classList.remove('active');
            });
            document.getElementById('closeTopProductForm').addEventListener('click', () => {
                document.getElementById('topProductFormModal').classList.remove('active');
            });

            // Category management
            document.getElementById('addCategoryBtn').addEventListener('click', addCategory);
            document.getElementById('saveCategoryBtn').addEventListener('click', saveCategory);
            document.getElementById('cancelCategoryBtn').addEventListener('click', () => {
                document.getElementById('categoryFormModal').classList.remove('active');
            });
            document.getElementById('closeCategoryForm').addEventListener('click', () => {
                document.getElementById('categoryFormModal').classList.remove('active');
            });

            // Order management
            document.getElementById('cancelOrderBtn').addEventListener('click', () => {
                if (confirm('هل أنت متأكد من إلغاء هذا الطلب؟')) {
                    updateOrderStatus('cancelled');
                }
            });

            document.getElementById('completeOrderBtn').addEventListener('click', () => {
                if (confirm('هل أنت متأكد من تأكيد استلام هذا الطلب؟')) {
                    updateOrderStatus('completed');
                }
            });

            document.getElementById('closeOrderDetails').addEventListener('click', () => {
                document.getElementById('orderDetailsModal').classList.remove('active');
            });

            document.getElementById('closeOrderBtn').addEventListener('click', () => {
                document.getElementById('orderDetailsModal').classList.remove('active');
            });

            // Close modals when clicking outside
            document.querySelectorAll('.modal-overlay').forEach(overlay => {
                overlay.addEventListener('click', (e) => {
                    if (e.target === overlay) {
                        overlay.classList.remove('active');
                    }
                });
            });

            // Setup image uploads
            setupImageUpload('heroUploadContainer', 'heroImagePreview', 'heroImageInput');
            setupImageUpload('productUploadContainer', 'productImagePreview', 'productImageInput');
            setupImageUpload('topProductUploadContainer', 'topProductImagePreview', 'topProductImageInput');

            // Enter key for login
            document.getElementById('adminPassword').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    document.getElementById('loginBtn').click();
                }
            });

            // Prevent form submission
            document.querySelectorAll('form').forEach(form => {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                });
            });
        }

        // ===== GLOBAL FUNCTIONS FOR HTML ATTRIBUTES =====
        window.addToCart = addToCart;
        window.addToCartFromTopProduct = addToCartFromTopProduct;
        window.updateCartQuantity = updateCartQuantity;
        window.removeFromCart = removeFromCart;
        window.editProduct = editProduct;
        window.deleteProduct = deleteProduct;
        window.editTopProduct = editTopProduct;
        window.deleteTopProduct = deleteTopProduct;
        window.deleteCategory = deleteCategory;
        window.showOrderDetails = showOrderDetails;
        window.filterByCategory = filterByCategory;
    </script>
</body>
</html>

